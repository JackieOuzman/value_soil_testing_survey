---
title: "Survey data analysis"
author: "Jackie Ouzman and Belinda Stummers"
date: "22/08/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

#install.packages("dplyr")
library(dplyr)
library(tidyverse)
library(ggplot2)
library(readxl)
library(DT)
#install.packages("scales")
library(scales)
#install.packages("formattable")
#install.packages("data.table")
library(data.table)
#library(formattable)
```

#### General notes 

* Note I have made some adjustment to the heading names in the excel sheet - many questions don't have numbers.
* I have used survey script to get the order correct.

```{r import dataset advisor, include=FALSE}

#These names are very long perhaps we can make them shorter?



headers <- read_excel("Nutrient Management Survey_Agrononomist09092019.xlsx", 
                   sheet = "Data", col_names=FALSE, range = "A1:HL1")
data <- read_excel("Nutrient Management Survey_Agrononomist09092019.xlsx", 
                   sheet = "Data", col_names=FALSE, range = "A5:HL174")
names(data) <- headers
```



```{r setting up the region names and order, include=FALSE}

table(data$Q_1)
data <- mutate(data,
             names_display =case_when(
               Q_1 == "SA - Mallee (low rainfall)" ~  "SA - Mallee",
               Q_1 == "SA – Lower EP (medium rainfall)" ~  "SA – Lower EP",
               Q_1 == "SA - Mid North (medium rainfall)" ~  "SA - Mid North",
               Q_1 == "SA - Yorke Peninsula (medium rainfall)" ~  "SA - Yorke Peninsula",
               Q_1 == "SA - Upper EP (low rainfall)" ~  "SA - Upper EP",
               Q_1 == "SA - South East (medium rainfall)" ~  "SA - South East",
               Q_1 == "VIC - Wimmera (medium rainfall)" ~  "VIC - Wimmera",
               Q_1 == "VIC - Mallee (low rainfall)" ~  "VIC - Mallee",
               Q_1 == "VIC - Southern region (high rainfall)" ~  "VIC - Southern region",
               Q_1 == "Other (please specify)" ~  "Other"))


data <- mutate(data, names_display = fct_relevel(names_display, c("SA - Mallee", 
                                       "SA – Lower EP", 
                                       "SA - Mid North", 
                                       "SA - Yorke Peninsula", 
                                       "SA - Upper EP", 
                                       "SA - South East", 
                                       "VIC - Wimmera",
                                       "VIC - Mallee",
                                       "VIC - Southern region",
                                       "Other")))

data <- mutate(data,
             region_merge =case_when(
               Q_1 == "SA - Mallee (low rainfall)" ~  "SA - Mallee",
               Q_1 == "SA – Lower EP (medium rainfall)" ~  "SA – EP",
               Q_1 == "SA - Mid North (medium rainfall)" ~  "SA - Mid North",
               Q_1 == "SA - Yorke Peninsula (medium rainfall)" ~  "SA - Yorke Peninsula",
               Q_1 == "SA - Upper EP (low rainfall)" ~  "SA – EP",
               Q_1 == "SA - South East (medium rainfall)" ~  "SA - South East",
               Q_1 == "VIC - Wimmera (medium rainfall)" ~  "VIC - Wimmera",
               Q_1 == "VIC - Mallee (low rainfall)" ~  "VIC - Mallee",
               Q_1 == "VIC - Southern region (high rainfall)" ~  "VIC - Southern region",
               Q_1 == "Other (please specify)" ~  "Other"))

data <- mutate(data, region_merge = fct_relevel(region_merge, c("SA - Mallee", 
                                       "SA – EP", 
                                       "SA - Mid North", 
                                       "SA - Yorke Peninsula", 
                                       
                                       "SA - South East", 
                                       "VIC - Wimmera",
                                       "VIC - Mallee",
                                       "VIC - Southern region",
                                       "Other")))


```





```{r setting up the states and rainfall, include=FALSE}


data <- mutate(data,
             states =case_when(
               Q_1 == "SA - Mallee (low rainfall)" ~  "SA",
               Q_1 == "SA – Lower EP (medium rainfall)" ~  "SA",
               Q_1 == "SA - Mid North (medium rainfall)" ~  "SA",
               Q_1 == "SA - Yorke Peninsula (medium rainfall)" ~  "SA",
               Q_1 == "SA - Upper EP (low rainfall)" ~  "SA",
               Q_1 == "SA - South East (medium rainfall)" ~  "SA",
               Q_1 == "VIC - Wimmera (medium rainfall)" ~  "VIC",
               Q_1 == "VIC - Mallee (low rainfall)" ~  "VIC",
               Q_1 == "VIC - Southern region (high rainfall)" ~  "VIC",
               Q_1 == "Other (please specify)" ~  "Other"))

data <- mutate(data, states = fct_relevel(states, c("SA", "VIC", "Other")))


data <- mutate(data,
             rainfall =case_when(
               Q_1 == "SA - Mallee (low rainfall)" ~  "low rainfall",
               Q_1 == "SA – Lower EP (medium rainfall)" ~  "medium rainfall",
               Q_1 == "SA - Mid North (medium rainfall)" ~  "medium rainfall",
               Q_1 == "SA - Yorke Peninsula (medium rainfall)" ~  "medium rainfall",
               Q_1 == "SA - Upper EP (low rainfall)" ~  "low rainfall",
               Q_1 == "SA - South East (medium rainfall)" ~  "medium rainfall",
               Q_1 == "VIC - Wimmera (medium rainfall)" ~  "medium rainfall",
               Q_1 == "VIC - Mallee (low rainfall)" ~  "low rainfall",
               Q_1 == "VIC - Southern region (high rainfall)" ~  "high rainfall",
               Q_1 == "Other (please specify)" ~  "Other"))

data <- mutate(data, rainfall = fct_relevel(rainfall, c("low rainfall", "medium rainfall", "high rainfall")))
```



#### **The first series of questions looks at your current farming practices.**


#### **Question 1** 

Agronomist) 
In which argo-ecological region do you work / are your clients based?

Grower) 
In which agro-ecological region do you farm?


```{r Q1 analysis and table, echo=FALSE}
#both agro and growers
Q1_resp_percent <- data %>% 
  count(Resp_Group) %>% 
  mutate(percent = 
           (freq = n / sum(n)))
#table
datatable(Q1_resp_percent, colnames = c('Respondent' = 'Resp_Group')) %>%
  formatPercentage('percent', 1) 
  
####graph
ggplot(Q1_resp_percent, aes(Resp_Group, percent, fill = Resp_Group))+
  geom_col()+
  scale_fill_manual(values=c("grey70", "grey40"))+
  theme_classic()+
  theme(legend.position = "none")+
  labs(x= "",
       y = "",
       fill = "",
       title = "",
       subtitle = "Survey respondents",
       caption = "Agronomist and Growers")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8)) + 
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L))   
 
```

##### **Question 1 by region** 
 
 
```{r Q1_by agro analysis and table, echo=FALSE}

#split into agro and growers
Q1_agro_region_perc <- filter(data, Resp_Group == "Agronomist") %>% 
  count( names_display) %>% 
  mutate(percent = round(
           (freq = n / sum(n)),2))

# datatable(Q1_agro_region_perc, colnames = c('Region' = 'names_display')) %>%
#   formatPercentage('percent', 0) 

#graph
ggplot(Q1_agro_region_perc, aes(names_display, percent ))+
  geom_col(fill = "grey70", color = "black")+
  theme_classic()+
  labs(x= "Regions",
       y = "Agronomist",
       fill = "",
       title = "",
       subtitle = "Survey respondents per region",
       caption = "")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8)) + 
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0, .6))    

```


```{r Q2_by growers analysis and table, echo=FALSE}

#split into agro and growers
Q1_grower_region_perc <- filter(data, Resp_Group == "Grower") %>% 
  count( names_display) %>% 
  mutate(percent = round( 
           (freq = n / sum(n)),2))

#table
#print(Q1_grower_region_perc)
#datatable(Q1_grower_region_perc, colnames = c( "regions", "count", "percentage"), caption = "Respondents per region - Grower")


#graph growers per region
ggplot(Q1_grower_region_perc, aes(names_display, percent ))+
  geom_col(fill = "grey40", color = "black")+
  theme_classic()+
  labs(x= "Regions",
       y = "Growers",
       fill = "",
       title = "",
       subtitle = "Survey respondents per region",
       caption = "")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8)) + 
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0, .6))    

```

#### **Question 1 by merged region** 


```{r Q1_by agro and grower by mergered region, echo=FALSE}

#split into agro and growers
Q1_agro_region_mereged_perc <- filter(data, Resp_Group == "Agronomist") %>% 
  count( region_merge) %>% 
  mutate(percent = round(
           (freq = n / sum(n)),2))


#graph
ggplot(Q1_agro_region_mereged_perc, aes(region_merge, percent ))+
  geom_col(fill = "grey70", color = "black")+
  #geom_text(aes(label = percent(signif(percent),1), vjust = -1.0, hjust = 0.5))+
  theme_classic()+
  labs(x= "Regions merged",
       y = "Agronomist",
       fill = "",
       title = "",
       subtitle = "Survey respondents per region",
       caption = "")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8)) + 
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,0.6))  


#split into agro and growers
Q1_grower_region_mereged_perc <- filter(data, Resp_Group == "Grower") %>% 
  count( region_merge) %>% 
  mutate(percent = round(
           (freq = n / sum(n)),2))


#graph
ggplot(Q1_grower_region_mereged_perc, aes(region_merge, percent ))+
  geom_col(fill = "grey40", color = "black")+
  #geom_text(aes(label = percent(signif(percent),1), vjust = -1.0, hjust = 0.5))+
  theme_classic()+
  labs(x= "Regions merged",
       y = "Grower",
       fill = "",
       title = "",
       subtitle = "Survey respondents per region",
       caption = "")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8)) + 
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,0.6))    

```


```{r Q2_by agro by states analysis and table, echo=FALSE}

#split into agro and growers
Q1_agro_state_perc <- filter(data, Resp_Group == "Agronomist") %>% 
  count( states) %>% 
  mutate(percent = round( 
           (freq = n / sum(n)),2))

Q1_grower_state_perc <- filter(data, Resp_Group == "Grower") %>% 
  count( states) %>% 
  mutate(percent = round( 
           (freq = n / sum(n)),2))



#graph agro per region
ggplot(Q1_agro_state_perc, aes(states, percent ))+
  geom_col(fill = "grey70", color = "black")+
  theme_classic()+
  labs(x= "States",
       y = "Agronomist",
       fill = "",
       title = "",
       subtitle = "Survey respondents per state",
       caption = "")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8)) + 
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,0.6))

#graph growers per region
ggplot(Q1_grower_state_perc, aes(states, percent ))+
  geom_col(fill = "grey40", color = "black")+
  theme_classic()+
  labs(x= "States",
       y = "Growers",
       fill = "",
       title = "",
       subtitle = "Survey respondents per state",
       caption = "")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8)) + 
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,0.6))

```



```{r Q2_by agro by rainfall analysis and table, echo=FALSE}

#split into agro and growers
Q1_agro_rainfall_perc <- filter(data, Resp_Group == "Agronomist") %>% 
  count( rainfall) %>% 
  mutate(percent = round( 
           (freq = n / sum(n)),2))

Q1_grower_rainfall_perc <- filter(data, Resp_Group == "Grower") %>% 
  count( rainfall) %>% 
  mutate(percent = round( 
           (freq = n / sum(n)),2))



#graph agro per region
ggplot(Q1_agro_rainfall_perc, aes(rainfall, percent ))+
  geom_col(fill = "grey70", color = "black")+
  theme_classic()+
  labs(x= "",
       y = "Agronomist",
       fill = "",
       title = "",
       subtitle = "Survey respondents per rainfall zone",
       caption = "")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8)) + 
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,0.6))

#graph growers per region
ggplot(Q1_grower_rainfall_perc, aes(rainfall, percent ))+
  geom_col(fill = "grey40", color = "black")+
  theme_classic()+
  labs(x= "",
       y = "Growers",
       fill = "",
       title = "",
       subtitle = "Survey respondents per rainfall zone",
       caption = "")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8)) + 
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,0.6))

```

#### **Comments notes on Question 1** 

* We have more grower(99) respondents than agronomist (71)
* For the growers by region we have some very low responses rates for certain regions (e.g. lower EP).
  This regional grouping (for growers) cannot be used as is, we will need to be merged regions are to reflect regional differences.
* I have added a merged region with EP upper and lower added together.



#### **Question 2** 
What is the average total area cropped (hectares) that you have managed for clients over the last 3 seasons?


```{r Q2 analysis and table, echo=FALSE}

Q2_regions <- group_by(data, names_display) %>% 
  summarise(
    count = n(),
    Ave_Cropped_Area = round(mean(`Q_2`), 0)) %>% 
    arrange(names_display)



```


```{r Q2 graph regions, eval=FALSE, include=FALSE}
ggplot(Q2_regions, aes(names_display, Ave_Cropped_Area))+
  geom_col()+
  theme_classic()+
  labs(x= "Regions",
       y = "ha",
       title = "Total area cropped",
       subtitle = "Agronomist and grower",
       caption = "Q)  What is your average total area cropped (hectares, including lease etc) over the last 3 seasons?")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8)) +
  scale_y_continuous(labels =  comma)
```

**Question 2 by regions** 

```{r Q2 graph regions agro only, echo=FALSE}
#head(data)

Q2_regions_agro_grower <- group_by(data, names_display, Resp_Group) %>% 
  summarise(
    count = n(),
    Ave_Cropped_Area = round(mean(`Q_2`), 0)) %>% 
    arrange(names_display)

#head(Q2_regions_agro_grower)

ggplot(Q2_regions_agro_grower, aes(names_display, Ave_Cropped_Area, fill= Resp_Group))+
  geom_col()+
  scale_fill_manual(values=c("grey70", "grey40"))+
  facet_wrap(.~ Resp_Group)+
  theme_classic()+
  theme(legend.position = "none")+
  labs(x= "Regions",
       y = "ha",
       title = "Total area cropped",
       subtitle = "",
       caption = "Q)  What is your average total area cropped (hectares, including lease etc) over the last 3 seasons?")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8)) +
  scale_y_continuous(labels =  comma)

```

**Question 2 by regions merged** 



```{r Q2 graph regions merged agro only, echo=FALSE}


Q2_regions_merged_agro_grower <- group_by(data, region_merge, Resp_Group) %>% 
  summarise(
    count = n(),
    Ave_Cropped_Area = round(mean(`Q_2`), 0))
    
#Q2_regions_merged_agro_grower

ggplot(Q2_regions_merged_agro_grower, aes(region_merge, Ave_Cropped_Area, fill =Resp_Group ))+
  geom_col()+
  scale_fill_manual(values=c("grey70", "grey40"))+
  facet_wrap(.~ Resp_Group)+
  theme_classic()+
  theme(legend.position = "none")+
  labs(x= "Regions",
       y = "ha",
       title = "Total area cropped",
       subtitle = "",
       caption = "Q)  What is your average total area cropped (hectares, including lease etc) over the last 3 seasons?")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8)) +
  scale_y_continuous(labels =  comma)

```

**Question 2** 


```{r Q2 graph agro_grower, echo=FALSE}


Q2_agro_grower <- group_by(data, Resp_Group) %>% 
  summarise(
    count = n(),
    Ave_Cropped_Area = round(mean(`Q_2`), 0)) 


#head(Q2_agro_grower)
datatable(Q2_agro_grower, colnames = c( "Respondents", "count", "Average cropped area"))

ggplot(Q2_agro_grower, aes(Resp_Group, Ave_Cropped_Area, fill = Resp_Group))+
  geom_col()+
  scale_fill_manual(values=c("grey70", "grey40"))+
  theme_classic()+
  labs(x= "",
       y = "Cropped area",
       title = "Total area cropped (hectares)",
       subtitle = "",
       caption = "Q)  What is your average total area cropped (hectares, including lease etc) over the last 3 seasons?")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8), legend.position = "none") +
  scale_y_continuous(labels =  comma)
```

#### **Comments notes on Question 2** 

* Total area of copping land is very different for agronomist compared to growers.
* Can't combine the data for this - perhaps indicates a pattern for the whole study (combining the two groups, growers with agronomist should be done with caution).
* Belinda Cay has added a farm size grouping for this question, her farms size grouping is:

* 0-1,000
* 1,000  - 5,000
* 5,000  - 10,000
* 10,000 - 20,000
* 20,000 - 30,000
* 30,000 - 40,000
* 40,000 - 50,000
* 50,000 - 100,000

* Agronomist manage on average 16,402ha while growers 27,97ha.
* Agronomist working in the SA Mallee and VIC Wimmera manage the largest amount of land.
* Areas that growers manage are much smaller.
* Growers in the EP (lower and upper) manage much larger farms as do growers in the mid north, note that Lower EP growers had a low response rate.

#### **Question 3** 

Which of the following crops do you grow - percentage by area?
 

(please enter a whole number without the % sign. Every row needs a number, so if there is none grown, please enter 0.)

3.1 Cereals (wheat, barley, oats)

3.2 Canola

3.3 Pulses (peas, beans, lupins, lentils, chickpeas)

3.4 Pasture

3.5 Hay

3.6 Fallow

```{r Q3 graph regions agro only, echo=FALSE}



data <- mutate(data,  area_cereal = Q_2 * (Q_3.1/100), 
                      area_canola = Q_2 * (Q_3.2/100),
                      area_pulses = Q_2 * (Q_3.3/100),
                      area_pasture = Q_2 * (Q_3.4/100),
                      area_hay = Q_2 * (Q_3.5/100),
                      area_fallow = Q_2 * (Q_3.6/100)
               )

Q3_regions_agro_grower <- group_by(data,  Resp_Group) %>% 
  summarise(
    Ave_ceral = round(mean(area_cereal), 0),
    Ave_canola = round(mean(area_canola), 0),
    Ave_pulse = round(mean(area_pulses), 0),
    Ave_pasture = round(mean(area_pasture), 0),
    Ave_hay = round(mean(area_hay), 0),
    Ave_fallow = round(mean(area_fallow), 0)
  )
#Q3_regions_agro_grower


Q3_regions_agro_grower_narrow <- gather(Q3_regions_agro_grower, 
                                        key = "crop", value = "ave_area",Ave_ceral:Ave_fallow )
#Q3_regions_agro_grower_narrow
Q3_regions_agro_grower_narrow <- mutate(Q3_regions_agro_grower_narrow, 
                                        crop = fct_relevel(crop, c("Ave_ceral" , "Ave_canola" , "Ave_pulse" ,
                                                                   "Ave_pasture" , "Ave_hay" , "Ave_fallow" )))

#head(Q3_regions_agro_grower_narrow, 40)

ggplot(Q3_regions_agro_grower_narrow, aes(x = crop, y = ave_area, fill = Resp_Group ))+
  geom_col()+
  scale_fill_manual(values=c("grey70", "grey40"))+
  facet_wrap(.~ Resp_Group)+
  theme_classic()+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(hjust = 0), legend.position = "none") +
  
  scale_x_discrete("crop", labels=c("Cereal","Canola", "Pulse", "Pasture","Hay", "Fallow"))+
  labs(x= "Regions",
       y = "Cropped area",
       title = "Average area by crop",
       subtitle = "",
       caption = "Q)  Which of the following crops do you grow - percentage by area? 
       NB percentage area of crop type is converted to cropped land using Q2
       Average total area cropped over the last 3 seasons")
  

```


#### **Comments notes on Question 2 and 3** 

* We have converted the percentage of crop type to area based on Q2 average total area cropped over the last 3 seasons.
* All agronomist and growers grow mainly cereal crops and the smallest portion of there land is used for fallow.
* Canola and pulses are also popular with both groups.
* Agronomist manage more canola than pulses, while for growers pulses are more popular than canola.


#### **Question 4**

Agro) 

When thinking about your average client's annual variable costs, what percentage would fertilisers account for?

Grower) 

Of your total annual variable costs, what percentage would fertilisers account for?



```{r Q4 graph regions agro only, echo=FALSE}
#head(data)
#table(data$Q_4)
##Looks like an error with data entry'greater than 35% and greater than 35% should be the same


data <- mutate(data,
             Q_4 =case_when(
               Q_4 == "'greater than 35%" ~  "greater than 35%",
               Q_4 == "greater than 35%" ~  "greater than 35%",
               TRUE ~ Q_4))
               
#table(data$Q_4)
#check out if we have any missing data for this question
  #data %>% group_by(Resp_Group) %>%
  #         summarise(sum(is.na(Q_4)))


Q4_resp_percent <- data %>% 
  group_by(Resp_Group) %>% 
  count(Q_4) %>% 
  mutate(percent = round(
           (freq = n / sum(n)),2))
#Q4_resp_percent


Q4_resp_percent$Q_4 <- factor(Q4_resp_percent$Q_4, 
                              levels = c("0-5%","5-10%", "10-15%","15-20%",
                                         "20-25%","25-30%", "30-35%", "greater than 35%", "Unsure" ))

filter(Q4_resp_percent, Resp_Group == 	"Agronomist" ) %>% 
datatable(Q4_resp_percent, colnames = c('Respondent' = 'Resp_Group')) %>%
  formatPercentage('percent', 0) 

filter(Q4_resp_percent, Resp_Group == 	"Grower" ) %>% 
datatable(Q4_resp_percent, colnames = c('Respondent' = 'Resp_Group')) %>%
  formatPercentage('percent', 0) 
 
ggplot(Q4_resp_percent, aes(Q_4, percent, fill =Resp_Group ))+
  geom_col()+
  scale_fill_manual(values=c("grey70", "grey40"))+
  facet_wrap(~Resp_Group)+
  theme_classic()+
  labs(x= "",
       y = "",
       title = "Percent of annual variable costs attributed to fertilisers",
       #subtitle = "Agronomist and grower",
       caption = "Q)  Of your total annual variable costs, what percentage would fertilisers account for?")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8), legend.position = "none") +
        scale_y_continuous("Respondent", breaks=seq(0, 1.0, 0.1)
                           , labels=c("0%", "10%", "20%", "30%", "40%", "50%", "60%", "70%", "80%", "90%", "100%"), limits = c(0,0.5))
  

```

**Question 4 with extra grouping of bins**

```{r Q4 graph more grouping, echo=FALSE}

data <- mutate(data,
               Q_4_group =case_when(
                 Q_4 == "0-5%" ~  "<20%",
                 Q_4 == "5-10%" ~  "<20%",
                 Q_4 == "10-15%" ~  "<20%",
                 Q_4 == "15-20%" ~  "<20%",
                 Q_4 == "20-25%" ~  "20-35%",
                 Q_4 == "25-30%" ~  "20-35%",
                 Q_4 == "30-35%" ~  "20-35%",
                 Q_4 == "greater than 35%" ~  ">35%",
                 Q_4 == "Unsure" ~  "Unsure"))


#with(data,table(Q_4_group,Resp_Group))


Q4group_resp_percent <- data %>% 
  group_by(Resp_Group) %>% 
  count(Q_4_group) %>% 
  mutate(percent = round(
    (freq = n / sum(n)),2))
#Q4group_resp_percent


Q4group_resp_percent$Q_4_group <- factor(Q4group_resp_percent$Q_4_group, 
                              levels = c("<20%","20-35%", ">35%", "Unsure" ))


ggplot(Q4group_resp_percent, aes(Q_4_group, percent, fill = Resp_Group ))+
  geom_col()+
  scale_fill_manual(values=c("grey70", "grey40"))+
  facet_wrap(~Resp_Group)+
  theme_classic()+
  labs(x= "percentage of total variable cost - more grouping",
       y = "percent response",
       title = "Percent of annual variable costs attributed to fertilisers",
       #subtitle = "Agronomist and grower",
       caption = "Q)  Of your total annual variable costs, what percentage would fertilisers account for?")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8), legend.position = "none") +
  scale_y_continuous("Respondent", breaks=seq(0, 1.0, 0.1)
                     , labels=c("0%", "10%", "20%", "30%", "40%", "50%", "60%", "70%", "80%", "90%", "100%"), limits = c(0,0.5))

```

**Question 4 with bins grouped and by regions merged**

```{r Q4 gregions, echo=FALSE}



Q4group_resp__regions_merged_percent <- data %>% 
  group_by(Resp_Group, region_merge) %>% 
  count(Q_4_group) %>% 
  mutate(percent = round(
    (freq = n / sum(n)),2))


Q4group_resp__regions_merged_percent$Q_4_group <- factor(Q4group_resp__regions_merged_percent$Q_4_group, 
                              levels = c("<20%","20-35%", ">35%", "Unsure" ))

# filter(Q4group_resp__regions_merged_percent, Resp_Group == "Agronomist") %>% 
# datatable(Q4group_resp__regions_merged_percent)

filter(Q4group_resp__regions_merged_percent, Resp_Group == "Agronomist") %>% 
ggplot( aes(Q_4_group, percent))+
  geom_col(fill = "grey70", color = "black")+
  facet_wrap(. ~ region_merge)+
  theme_classic()+
  labs(x= "percentage of total variable cost",
       y = "percent response",
       title = "Percent of annual variable costs attributed to fertilisers - more grouping",
       subtitle = "Agronomist",
       caption = "Q)  Of your total annual variable costs, what percentage would fertilisers account for?")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8)) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,0.75))


filter(Q4group_resp__regions_merged_percent, Resp_Group == "Grower") %>% 
ggplot( aes(Q_4_group, percent))+
  geom_col(fill = "grey40", color = "black")+
  facet_wrap(. ~ region_merge)+
  theme_classic()+
  labs(x= "percentage of total variable cost",
       y = "percent response",
       title = "Percent of annual variable costs attributed to fertilisers - more grouping",
       subtitle = "Grower",
       caption = "Q)  Of your total annual variable costs, what percentage would fertilisers account for?")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8)) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,0.75))

```

Note that precenatges is calculated for each regional grouping (by agronomist or grower)

**Question 4 with bins grouped and by rainfall**

```{r Q4 regions, echo=FALSE}



Q4group_resp__rainfall_percent <- data %>% 
  group_by(Resp_Group, rainfall) %>% 
  count(Q_4_group) %>% 
  mutate(percent = round(
    (freq = n / sum(n)),2))


Q4group_resp__rainfall_percent$Q_4_group <- factor(Q4group_resp__rainfall_percent$Q_4_group, 
                              levels = c("<20%","20-35%", ">35%", "Unsure" ))


filter(Q4group_resp__rainfall_percent, Resp_Group == "Agronomist") %>%
datatable(Q4group_resp__rainfall_percent)
filter(Q4group_resp__rainfall_percent, Resp_Group == "Grower") %>%
datatable(Q4group_resp__rainfall_percent)


filter(Q4group_resp__rainfall_percent, Resp_Group == "Agronomist") %>% 
ggplot( aes(Q_4_group, percent))+
  geom_col(fill = "grey70", color = "black")+
  facet_wrap(. ~ rainfall)+
  theme_classic()+
  labs(x= "percentage of total variable cost",
       y = "percent response",
       title = "Percent of annual variable costs attributed to fertilisers - more grouping",
       subtitle = "Agronomist",
       caption = "Q)  Of your total annual variable costs, what percentage would fertilisers account for?")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8)) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,1))


filter(Q4group_resp__rainfall_percent, Resp_Group == "Grower") %>% 
ggplot( aes(Q_4_group, percent))+
  geom_col(fill = "grey40", color = "black")+
  facet_wrap(. ~ rainfall)+
  theme_classic()+
  labs(x= "percentage of total variable cost",
       y = "percent response",
       title = "Percent of annual variable costs attributed to fertilisers - more grouping",
       subtitle = "Grower",
       caption = "Q)  Of your total annual variable costs, what percentage would fertilisers account for?")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8)) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L))

```

Note that percentages is calculated for each rainfall grouping (by agronomist or grower)

#### **Comments notes on Question 4** 


* Question and answer results in a percent of percent - convert to a table?
* I have grouped the bins
* Note that in the original survey there is a problem with the coding of >35%, it is fixed here. This means that prelim report is wrong, the report says 5% but is more like 9% of growers estimate the fertiliser expenditure was more than 30%.
* Agronomist estimate that over 20% of there clients spend more than 35% of there variable cost on fertiliser, while less than 10% of growers spend this amount.
* Generally growers spend less on fertilisers than what agronomist suggest. Almost 40% of growers spend less than 20% of there variable costs on fertilisers.
* when the bins are grouped into 4 classes only, close to 50% of both growers and agronomist suggest that they spend between 20-35% of there variable costs on fertilisers.
* I have reported fertiliser cost per region and rainfall, but the sample size is very low for some of these classes.



#### **Question 5**
Agro) 

What are the main nutrient deficiencies your clients encounter?

Grower)

What are the main nutrient deficiencies on your farm?

```{r Q5 new nutrient def clms, include=FALSE}
data <- mutate(data, 
               Q_5.2_N = case_when(str_detect(Q_5.2,   fixed("N",  ignore_case = TRUE)) ~ "N", TRUE ~ "NA"),
               Q_5.2_P = case_when(str_detect(Q_5.2,   fixed("P",  ignore_case = TRUE)) ~ "P", TRUE ~ "NA"),
               Q_5.2_S = case_when(str_detect(Q_5.2,   fixed("S",  ignore_case = TRUE)) ~ "S", TRUE ~ "NA"),
               Q_5.2_Zn = case_when(str_detect(Q_5.2,  fixed("Zn",  ignore_case = TRUE)) ~ "Zn", TRUE ~ "NA"),
               Q_5.2_Cu = case_when(str_detect(Q_5.2,  fixed("Cu",  ignore_case = TRUE)) ~ "Cu", TRUE ~ "NA"),
               Q_5.2_Mn = case_when(str_detect(Q_5.2,  fixed("Mn",  ignore_case = TRUE)) ~ "Mn", TRUE ~ "NA"),
               Q_5.2_pH = case_when(str_detect(Q_5.2,  fixed("pH",  ignore_case = TRUE)) ~ "pH", TRUE ~ "NA"),
               Q_5.2_Fe = case_when(str_detect(Q_5.2,  fixed("Fe",  ignore_case = TRUE)) ~ "Fe", TRUE ~ "NA"),
               Q_5.2_Mg = case_when(str_detect(Q_5.2,  fixed("Mg",  ignore_case = TRUE)) ~ "Mg", TRUE ~ "NA")
)


Q_5.2_N <- data %>% 
  group_by(Resp_Group) %>% 
  count(Q_5.2_N) %>% 
  mutate(percent = 
           (freq = n / sum(n))) %>% 
  filter(Q_5.2_N != "NA") %>% 
  select(Resp_Group, percent) %>% 
  mutate( nutrient = "N")

Q_5.2_P <- data %>% 
  group_by(Resp_Group) %>% 
  count(Q_5.2_P) %>% 
  mutate(percent = round(
    (freq = n / sum(n)),2)) %>% 
  filter(Q_5.2_P != "NA") %>% 
  select(Resp_Group, percent) %>% 
  mutate( nutrient = "P")

Q_5.2_S <- data %>% 
  group_by(Resp_Group) %>% 
  count(Q_5.2_S) %>% 
  mutate(percent = round(
    (freq = n / sum(n)),2)) %>% 
  filter(Q_5.2_S != "NA") %>% 
  select(Resp_Group, percent) %>% 
  mutate( nutrient = "S")

Q_5.2_Zn <- data %>% 
  group_by(Resp_Group) %>% 
  count(Q_5.2_Zn) %>% 
  mutate(percent = round(
    (freq = n / sum(n)),2)) %>% 
  filter(Q_5.2_Zn != "NA") %>% 
  select(Resp_Group, percent) %>% 
  mutate( nutrient = "Zn")

Q_5.2_Cu <- data %>% 
  group_by(Resp_Group) %>% 
  count(Q_5.2_Cu) %>% 
  mutate(percent = round(
    (freq = n / sum(n)),2)) %>% 
  filter(Q_5.2_Cu != "NA") %>% 
  select(Resp_Group, percent) %>% 
  mutate( nutrient = "Cu")

Q_5.2_Mn <- data %>% 
  group_by(Resp_Group) %>% 
  count(Q_5.2_Mn) %>% 
  mutate(percent = round(
    (freq = n / sum(n)),2)) %>% 
  filter(Q_5.2_Mn != "NA") %>% 
  select(Resp_Group, percent) %>% 
  mutate( nutrient = "Mn")

Q_5.2_pH <- data %>% 
  group_by(Resp_Group) %>% 
  count(Q_5.2_pH) %>% 
  mutate(percent = round(
    (freq = n / sum(n)),2)) %>% 
  filter(Q_5.2_pH != "NA") %>% 
  select(Resp_Group, percent) %>% 
  mutate( nutrient = "pH")

Q_5.2_Fe <- data %>% 
  group_by(Resp_Group) %>% 
  count(Q_5.2_Fe) %>% 
  mutate(percent = round(
    (freq = n / sum(n)),2)) %>% 
  filter(Q_5.2_Fe != "NA") %>% 
  select(Resp_Group, percent) %>% 
  mutate( nutrient = "Fe")

Q_5.2_Mg <- data %>% 
  group_by(Resp_Group) %>% 
  count(Q_5.2_Mg) %>% 
  mutate(percent = round(
    (freq = n / sum(n)),2)) %>% 
  filter(Q_5.2_Mg != "NA") %>% 
  select(Resp_Group, percent) %>% 
  mutate( nutrient = "Mg")

### These are the same size and can be mereged as is...
nutr_def <- rbind(Q_5.2_N, Q_5.2_P, Q_5.2_S,  Q_5.2_Zn,
              Q_5.2_Cu, Q_5.2_Mn, Q_5.2_pH, Q_5.2_Fe, Q_5.2_Mg ) 

add_lines <- tibble (Resp_Group = c("Grower", "Grower"),
                         percent = c(0, 0),
                         nutrient = c("Fe", "Mg"))

nutr_def_all <- full_join(nutr_def, add_lines)


nutr_def_all <- mutate(nutr_def_all, nutrient = fct_relevel(nutrient, c("N", "P", 
                                                                "S", 
                                                                "Zn", 
                                                                "Cu", 
                                                                "Mn",
                                                                "pH",
                                                                "Fe",
                                                                "Mg")))


```


```{r Q5 new nutrient def clms graph, echo=FALSE}


filter(nutr_def_all, Resp_Group == "Agronomist") %>%
datatable(nutr_def_all) %>% 
  formatPercentage('percent', 0) 

filter(nutr_def_all, Resp_Group == "Grower") %>%
datatable(nutr_def_all) %>% 
  formatPercentage('percent', 0) 

ggplot( nutr_def_all, aes(nutrient, percent, fill = Resp_Group ))+
  geom_col()+
  scale_fill_manual(values=c("grey70", "grey40"))+
  facet_wrap(. ~ Resp_Group)+
  theme_classic()+
  labs(x= "",
       y = "Percent",
       title = "Percent of clients / growers with type of nutrient deficiencies",
       subtitle = "",
       caption = "Q)  What are the main nutrient deficiencies")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8), legend.position = "none") +
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L))


```

This might be a bit confusing, here we have pulled out all the responses that had a certain deficiency and then calculated the percentage of growers / or agronomist that have this deficiency.
For example for nitrogen; of the 71 agronomist 60 said they have client n deficiency - so this is 85%



#### **Question 6** 
Agro) 

Do you recommend soil and or plant testing?

Grower)

Do you do soil and/or plant testing on your farm?


```{r Q6 agro summary agro and grower, echo=FALSE}

#check out if we have any missing data for this question
 # data %>% group_by(Resp_Group) %>%
 #          summarise(sum(is.na(Q_6)))


Q6_all_agro <- filter(data, Resp_Group == "Agronomist") %>% 
  count(Q_6) %>% 
  mutate(percent = 
        (freq = n / sum(n)))

Q6_all_agro <- group_by(data, Resp_Group) %>% 
  count(Q_6) %>% 
  mutate(percent = 
        (freq = n / sum(n)))

#head(Q6_all_agro)

ggplot(Q6_all_agro, aes(Q_6, percent, fill = Resp_Group))+
  geom_col()+
  geom_text(aes(label = percent(signif(percent),1), vjust = -1.0, hjust = 0.5))+
  scale_fill_manual(values=c("grey70", "grey40"))+
  theme_classic()+
  facet_wrap(~ Resp_Group)+
  labs(x= "All regions",
       y = "",
       title = "Recommend soil and or plant testing",
       subtitle = "",
       caption = "Q) Do you recommend soil and or plant testing?")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8), legend.position = "none") + 
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits=c(0, 1.1))
```


```{r Q6 regions merged summary , echo=FALSE}
#agronomist by region

#check out if we have any missing data for this question
  #data %>% group_by(Resp_Group) %>%
  #         summarise(sum(is.na(Q_6)))

Q6_by_Region_merge <- 
  group_by(data, region_merge, Resp_Group) %>%
  count(Q_6) %>% 
  mutate(percent = 
           (freq = n / sum(n)))

#head(Q6_by_Region_merge)

ggplot(Q6_by_Region_merge, aes(region_merge, percent, fill=Q_6 ))+
  geom_col()+
  facet_wrap(. ~ Resp_Group)+
  #geom_text(aes(label = percent(signif(percent),1), vjust = -1.0, hjust = 0.5))+
  theme_classic()+
  labs(x= "Regions",
       y = "",
       fill = "",
       title = "Recommend soil and or plant testing",
       subtitle = "",
       caption = "Q) Do you recommend soil and or plant testing?")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8)) + 
  scale_y_continuous(labels = scales::percent)

```




```{r Q6 agro summary agronomist saying no, echo=FALSE}

filter(Q6_by_Region_merge, Q_6 == "No") %>% 
ggplot(aes(region_merge, percent, fill = Resp_Group))+
  geom_col()+
  scale_fill_manual(values=c("grey70", "grey40"))+
  facet_wrap(~ Resp_Group)+
  geom_text(aes(label = percent(signif(percent),1), vjust = -1.0, hjust = 0.5))+
  theme_classic()+
  labs(x= "Regions",
       y = "",
       title = "Not recommending soil and or plant testing",
       subtitle = "",
       caption = "Q) Do you recommend soil and or plant testing?")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8), legend.position = "none" ) +
        scale_y_continuous("Percentage not testing", limits=c(0, 0.7),breaks=seq(0, 1.0, 0.1)
                           , labels=c("0%", "10%", "20%", "30%", "40%", "50%", "60%", "70%", "80%", "90%", "100%"))


```



# **Decision making**


#### **Question 7**

Grower

Who makes the nutrient decisions on your farm?

* Self
* Agronomist
* Combination of agronomist and self
* Other
* Other (please specify)

```{r Q7 awho makes decision, echo=FALSE}

Q7 <- filter (data, Resp_Group == "Grower" &  Q_7 !=  "NA")%>%
  group_by( Resp_Group) %>%
  count(Q_7) %>% 
  mutate(percent = 
           (freq = n / sum(n)))

Q7 <- mutate(Q7, Q_7 = fct_relevel(Q_7, c("Agronomist", "Self", 
                                                                "Combination of agronomist and self" , 
                                                                "Other")))

ggplot(Q7, aes(Q_7 , percent ))+
  geom_col(fill = "grey40", color = "black")+
  #facet_wrap(. ~ Resp_Group)+
  #geom_text(aes(label = percent(signif(percent),1), vjust = -1.0, hjust = 0.5))+
  theme_classic()+
  labs(x= "",
       y = "",
       fill = "",
       title = "Decisions on your farm?",
       subtitle = "Growers only",
       caption = "Q) Who makes the nutrient decisions on your farm?")+
  theme(axis.text.x=element_text(angle=45,hjust=1),
        plot.caption = element_text(size = 8), legend.position = "none") + 
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits=c(0, 0.8))
```




#### **Question 8**

Agronomist


* Q8.1 Of your clients, how many of them rely **entirely** on you to make the nutrient decisions?

* Q8.2 Of your clients, how many of them rely **somewhat** on you to make the nutrient decisions?

* Q8.3 Of your clients, how many of them make their **own** nutrient decisions?

```{r Q8.1 who makes decision, echo=FALSE}
Q8_1 <- filter (data, Resp_Group == "Agronomist" &  Q_8.1 !=  "NA")%>%
  group_by( Resp_Group) %>%
  count(Q_8.1) %>% 
  mutate(percent = 
           (freq = n / sum(n)))


Q8_1 <- mutate(Q8_1, Q_8.1 = fct_relevel(Q_8.1, c("less than 10%", "10-30%", "30-50%", "50-70%",
                                                  "70-90%","90-100%"
                                          )))

ggplot(Q8_1, aes(Q_8.1 , percent ))+
  geom_col(fill = "grey70", color = "black")+
  theme_classic()+
  labs(x= "",
       y = "",
       fill = "",
       title = "Rely entirely on agronomist to make nutrient decisions?",
       subtitle = "Agronomist only",
       caption = "Q) Of your clients, how many of them rely entirely on you to make the nutrient decisions?")+
  theme(axis.text.x=element_text(angle=45,hjust=1),
        plot.caption = element_text(size = 8)) + 
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits=c(0, 0.8))

```


```{r Q8.2 who makes decision, echo=FALSE}
Q8_2 <- filter (data, Resp_Group == "Agronomist" &  Q_8.2 !=  "NA")%>%
  group_by( Resp_Group) %>%
  count(Q_8.2) %>% 
  mutate(percent = 
           (freq = n / sum(n)))
#Q8_2

Q8_2 <- mutate(Q8_2, Q_8.2 = fct_relevel(Q_8.2, c("less than 10%", "10-30%", "30-50%", "50-70%",
                                                  "70-90%", "90-100%"
)))

ggplot(Q8_2, aes(Q_8.2 , percent ))+
  geom_col(fill = "grey70", color = "black")+
  theme_classic()+
  labs(x= "",
       y = "",
       fill = "",
       title = "Rely somewhat on agronomist to make nutrient decisions?",
       subtitle = "Agronomist only",
       caption = "Q) Of your clients, how many of them rely somewhat on you to make the nutrient decisions?")+
  theme(axis.text.x=element_text(angle=45,hjust=1),
        plot.caption = element_text(size = 8), legend.position = "none") + 
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits=c(0, 0.8))

```

```{r Q8.3 who makes decision, echo=FALSE, warning=FALSE}

Q8_3 <- filter (data, Resp_Group == "Agronomist" &  Q_8.3 !=  "NA")%>%
  group_by( Resp_Group) %>%
  count(Q_8.3) %>% 
  mutate(percent = 
           (freq = n / sum(n)))


Q8_3 <- mutate(Q8_3, Q_8.3 = fct_relevel(Q_8.3, c("less than 10%", "10-30%", "30-50%",  "50-70%",
                                                  "70-90%", "90-100%"
)))

ggplot(Q8_3, aes(Q_8.3 , percent ))+
  geom_col(fill = "grey70", color = "black")+
  theme_classic()+
  labs(x= "",
       y = "",
       fill = "",
       title = "Make their own nutrient decisions?",
       subtitle = "Agronomist only",
       caption = "Q) Of your clients, how many of them make their own nutrient decisions??")+
  theme(axis.text.x=element_text(angle=45,hjust=1),
        plot.caption = element_text(size = 8), legend.position = "none") + 
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits=c(0, 0.8))

```

#### **Question 9**

Agronomist

Q9.1 To what extent are you responsible for determining how much testing is done on your clients' farms?

Grower

Q 9.1 To what extent does your agronomist determine how much testing is done on your farm? (i.e. % of decision made by your agronomist)

```{r Q9.1 how much testing, message=FALSE, warning=TRUE, include=FALSE}

#sum(is.na(data$Q_9.1)) #number of NA in this Question

data <- mutate(data,
               Q_9.1 =case_when(
                 Q_9.1 == "90-100%" ~  ">90%",
                 Q_9.1 == "100%" ~  ">90%",
                 TRUE ~ Q_9.1
                 ))

#data$Q_9.1

Q9_1 <- filter (data,   Q_9.1 !=  "NA")%>%
  group_by( Resp_Group) %>%
  count(Q_9.1) %>% 
  mutate(percent = 
           (freq = n / sum(n)))

#Q9_1

add_lines9 <- tibble (Resp_Group = c("Grower", "Agronomist"),
                      percent = c(0, 0),
                      Q_9.1 = c( "less than 10%", "None"))
#add_lines9
Q9_1 <- full_join(Q9_1, add_lines9)

#Q9_1
Q9_1 <- mutate(Q9_1, Q_9.1 = fct_relevel(Q_9.1, c("less than 10%", "10-30%", "30-50%", "50-70%",
                                                  "70-90%", ">90%", "None")))

```

```{r Q9.1 graph how much testing, echo=FALSE, message=FALSE, warning=TRUE}
ggplot(Q9_1, aes(Q_9.1 , percent, fill =  Resp_Group))+
  geom_col()+
  facet_wrap(. ~ Resp_Group)+
  scale_fill_manual(values=c("grey70", "grey40"))+
  #geom_text(aes(label = percent(signif(percent),1), vjust = -1.0, hjust = 0.5))+
  theme_classic()+
  labs(x= "",
       y = "",
       fill = "",
       title = "To what extent determined testing?",
       subtitle = "",
       caption = "Q) To what extent are you responsible for determining how much testing is done on your clients' farms?
                     To what extent does your agronomist determine how much testing is done on your farm? ")+
  theme(axis.text.x=element_text(angle=45,hjust=1),
        plot.caption = element_text(size = 8), legend.position = "none") + 
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits=c(0, 0.5))

```


```{r Q9.2 how much testing, echo=FALSE, message=FALSE, warning=TRUE}

otherQ9.2 <- filter(data, Q_9.2 !=  "NA") %>% select(Q_9.2, Resp_Group)
datatable(otherQ9.2, colnames = c( "other reasons" = "Q_9.2"))

```



#### **Comments notes on Question 9.1 and 9.2** 
Combined results for 90-100 and 100% to read >90%. Included None (responses) for Agronomist
Q9.2 other comments listed

#### **Question 10** 


Agronomist (Q_10.1)

To what extent do the test results influence your recommendations?

Grower (Q_10.1)

To what extent does your agronomist make recommendations based on the test results from your farm?


Agronomist other (Q_10.2)
This is text answer nominated by 6 agronomists.

* dependent upon nutrient
* I do my own moisture test and own gut feel from visual and in season responses.
* Historical decision making. 1 year once off can't guide too accurately.
* basal amounts, peak and flow even around basal amounts 
* rainfall 
* Lime more than P


```{r Q10.1 how much testing, echo=FALSE, message=FALSE, warning=TRUE}
#suss out how many ans questions

#temp_agro <- filter(data,Resp_Group == "Agronomist" ) 
#sum(is.na(temp_agro$Q_10.1)) #number of NA in this Question
#temp_grower <- filter(data,Resp_Group == "Grower" ) 
#sum(is.na(temp_grower$Q_10.1)) #number of NA in this Question

data <- mutate(data,
               Q_10.1 =case_when(
                 Q_10.1 == "90-100%" ~  ">90%",
                 Q_10.1 == "100%" ~  ">90%",
                 TRUE ~ Q_10.1
                 ))

Q10_1 <- filter (data,   Q_10.1 !=  "NA")%>%
  group_by( Resp_Group) %>%
  count(Q_10.1) %>% 
  mutate(percent = 
           (freq = n / sum(n)))
Q10_1
add_lines10 <- tibble (Resp_Group = c("Agronomist"),
                    percent = c(0),
Q_10.1 = c( "None" ))
Q10_1 <- full_join(Q10_1, add_lines10)

Q10_1 <- mutate(Q10_1, Q_10.1 = fct_relevel(Q_10.1, c("10-30%", "30-50%", "50-70%",
                                                  "70-90%", ">90%" ,"None")))



ggplot(Q10_1, aes(Q_10.1 , percent ))+
  geom_col()+
  facet_wrap(. ~ Resp_Group)+
  #geom_text(aes(label = percent(signif(percent),1), vjust = -1.0, hjust = 0.5))+
  theme_classic()+
  labs(x= "",
       y = "Percent",
       fill = "",
       title = "To what extent do test results have a influence?",
       subtitle = "",
       caption = "Q)  To what extent do the test results influence your recommendations? 
       To what extent does your agronomist make recommendations based on the test results from your farm? ")+
  
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(hjust = 0)) +
 
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits=c(0, 0.5))




```


```{r Q10.1 how much testing more bins, echo=FALSE, message=FALSE, warning=TRUE}
data <- mutate(data,
               Q_10_1group =case_when(
                 Q_10.1 == "None" ~  "not much of the time",
                 Q_10.1 == "10-30%" ~  "not much of the time",
                 Q_10.1 == "30-50%" ~  "not much of the time",
                 Q_10.1 == "50-70%" ~  "most of the time",
                 Q_10.1 == ">90%" ~  "most of the time"
                 # Q_10.1 == "100%" ~  "most of the time"
               ))

Q10_1_group_df <- filter (data,   Q_10_1group !=  "NA")%>%
  group_by( Resp_Group) %>%
  count(Q_10_1group) %>% 
  mutate(percent = 
           (freq = n / sum(n)))

#Q10_1_group_df

ggplot(Q10_1_group_df, aes(Q_10_1group , percent ))+
  geom_col()+
  facet_wrap(. ~ Resp_Group)+
  #geom_text(aes(label = percent(signif(percent),1), vjust = -1.0, hjust = 0.5))+
  theme_classic()+
  labs(x= "",
       y = "",
       fill = "",
       title = "To what extent do test results have influence?",
       subtitle = "",
       caption = "Q) To what extent do the test results influence your recommendations?
                     To what extent does your agronomist make recommendations based on the test results from your farm? ")+
  
  theme(axis.text.x=element_text(angle=45,hjust=1),
        plot.caption = element_text(hjust = 1)) +
  
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits=c(0, 0.8))
```


```{r Q10.2 how much testing, echo=FALSE, message=FALSE, warning=TRUE}

otherQ10.2 <- filter(data, Q_10.2 !=  "NA") %>% select(Q_10.2, Resp_Group)
otherQ10.2
```


#### **Comments notes on Question 10.1 and 10.2** 

* Combined results for 90-100 and 100% to read >90%. Included None (responses) for Agronomist
Q10.2 

* 51 people didn't respond to this question: 43 growers and 8 agronomists
* the question was asked as a percentage - this make the graph / analysis a percentage of a percentage, which is hard to interpreter
* note that it seems agronomist had a bin 90-100% and growers had a bin 100%
* more grouping and analysis?? for example most of the time > 50%  and not much of the time <50%


#### **Question 11**
Agronomist

What are your 3 main sources of information or advice for what nutrients you recommend and at what rate? 

Indicate if this is different for N, P and other nutrients

* Source 1
* Source 2
* Source 3

Grower

What are your 3 main sources of information or advice for what nutrients you apply and at what rate? 

Indicate if this is different for N, P and other nutrients

* Source 1
* Source 2
* Source 3

Note 
Q_11.1 is source 1 as answered (?)
Q_11.2 is source 1 coded dropping the indication if different


```{r Q11.2 source of advice, echo=FALSE, message=FALSE, warning=TRUE}

######################          THIS IS BETTER              #####################


data$Q_11.2

### use this this to count the how many we have in each class
subsetQ_11_coded_agro <- select(data, Q_11.2, Q_11.4, Q_11.6, Resp_Group) %>% 
  filter(Resp_Group == "Agronomist" )

#sum(is.na(subsetQ_11_coded_agro$Q_11.2)) #number of NA in this Question 11
#sum(is.na(subsetQ_11_coded_agro$Q_11.4)) #number of NA in this Question 14
#sum(is.na(subsetQ_11_coded_agro$Q_11.6)) #number of NA in this Question 24

subsetQ_11_coded_grower <- select(data, Q_11.2, Q_11.4, Q_11.6, Resp_Group) %>% 
  filter(Resp_Group == "Grower" )


subsetQ_11_coded_agro
###By Agro

subsetQ_11.2_coded <- as.data.frame(count(subsetQ_11_coded_agro, vars = Q_11.2))
#subsetQ_11.2_coded
names(subsetQ_11.2_coded) <- c("source", "Q_11.2_count") 
#subsetQ_11.2_coded
subsetQ_11.4_coded <- as.data.frame(count(subsetQ_11_coded_agro, vars = Q_11.4))
names(subsetQ_11.4_coded) <- c("source", "Q_11.4_count") 
subsetQ_11.6_coded <- as.data.frame(count(subsetQ_11_coded_agro, vars = Q_11.6))
names(subsetQ_11.6_coded) <- c("source", "Q_11.6_count") 

#subsetQ_11.2_coded
#subsetQ_11.4_coded
#subsetQ_11.6_coded
#join all the count data togther

subsetQ_11_coded_agro_1 <- full_join(subsetQ_11.2_coded, subsetQ_11.4_coded )
#subsetQ_11_coded_agro_1
subsetQ_11_coded_agro <- full_join(subsetQ_11_coded_agro_1, subsetQ_11.6_coded )
#subsetQ_11_coded_agro

subsetQ_11_coded_agro$Q_11.2_count[is.na(subsetQ_11_coded_agro$Q_11.2_count)] <- 0
subsetQ_11_coded_agro$Q_11.4_count[is.na(subsetQ_11_coded_agro$Q_11.4_count)] <- 0
subsetQ_11_coded_agro$Q_11.6_count[is.na(subsetQ_11_coded_agro$Q_11.6_count)] <- 0
#subsetQ_11_coded_agro[is.na(subsetQ_11_coded_agro)] <- 0 # change NA to zero
#subsetQ_11_coded_agro

subsetQ_11_coded_agro <- filter(subsetQ_11_coded_agro, source != "NA")

subsetQ_11_coded_agro <- mutate(subsetQ_11_coded_agro, sum_count_sources = (Q_11.2_count + Q_11.4_count + Q_11.6_count)) #count the numbers in each source
#sum(subsetQ_11_coded_agro$sum_count_sources)
#subsetQ_11_coded_agro
subsetQ_11_coded_agro <- mutate(subsetQ_11_coded_agro, 
                                percent_source1 = (Q_11.2_count)/ sum(Q_11.2_count),
                                percent_all_sources = (sum_count_sources)/ sum(subsetQ_11_coded_agro$sum_count_sources))
#subsetQ_11_coded_agro
#sum(subsetQ_11_coded_agro$percent)

subsetQ_11_coded_agro <- mutate(subsetQ_11_coded_agro, 
                                source = fct_relevel(source, c("Test results", 
                                                               "Farm history/experience", 
                                                               "Industry data, research or agronomy tools",
                                                                "Yield maps/Data", 
                                                                "Yield modelling/estimates" ,
                                                                "Industry contacts",
                                                               "Local Trials",
                                                               "Other agronomists",
                                                               "Client expectations/targets",
                                                               "Seasonal economic environment",
                                                               "Local farming groups & events"
                                                               )))

ggplot(subsetQ_11_coded_agro, aes( source , percent_source1 ))+
  geom_col()+
  #facet_wrap(. ~ Resp_Group)+
  #geom_text(aes(label = percent(signif(percent),1), vjust = -1.0, hjust = 0.5))+
  theme_classic()+
  labs(x= "",
       y = "",
       fill = "",
       title = "Main sources of information or advice for what nutrients (source one only)",
       subtitle = "Agronomist only",
       caption = "Q) What are your 3 main sources of information or advice for what nutrients you recommend and at what rate? 
                     To what extent does your agronomist make recommendations based on the test results from your farm? ")+
  
  theme(axis.text.x=element_text(angle=45,hjust=1),
        plot.caption = element_text(hjust = 1)) +
  
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits=c(0, 0.8))

ggplot(subsetQ_11_coded_agro, aes( source , percent_all_sources ))+
  geom_col()+
  #facet_wrap(. ~ Resp_Group)+
  #geom_text(aes(label = percent(signif(percent),1), vjust = -1.0, hjust = 0.5))+
  theme_classic()+
  labs(x= "",
       y = "",
       fill = "",
       title = "Main three sources of information or advice for what nutrients",
       subtitle = "Agronomist only",
       caption = "What are your 3 main sources of information or advice for what nutrients you recommend and at what rate? 
                     To what extent does your agronomist make recommendations based on the test results from your farm?  ")+
  theme(axis.text.x=element_text(angle=45,hjust=1),
        plot.caption = element_text(hjust = 1)) +
  
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits=c(0, 0.8))

```


```{r Q11.2 source of advice grower, echo=FALSE, message=FALSE, warning=TRUE}


### use this this to count the how many we have in each class

subsetQ_11_coded_grower <- select(data, Q_11.2, Q_11.4, Q_11.6, Resp_Group) %>% 
  filter(Resp_Group == "Grower" )


#sum(is.na(subsetQ_11_coded_grower$Q_11.2)) #number of NA in this Question 44
#sum(is.na(subsetQ_11_coded_grower$Q_11.4)) #number of NA in this Question 47
#sum(is.na(subsetQ_11_coded_grower$Q_11.6)) #number of NA in this Question 57

#subsetQ_11_coded_grower
###By Grower

subsetQ_11.2_codedg <- as.data.frame(count(subsetQ_11_coded_grower, vars = Q_11.2))
#subsetQ_11.2_codedg
names(subsetQ_11.2_codedg) <- c("source", "Q_11.2_count") 
#subsetQ_11.2_codedg
subsetQ_11.4_codedg <- as.data.frame(count(subsetQ_11_coded_grower, vars = Q_11.4))
names(subsetQ_11.4_codedg) <- c("source", "Q_11.4_count") 
subsetQ_11.6_codedg <- as.data.frame(count(subsetQ_11_coded_grower, vars = Q_11.6))
names(subsetQ_11.6_codedg) <- c("source", "Q_11.6_count") 

#subsetQ_11.2_codedg
#subsetQ_11.4_codedg
#subsetQ_11.6_codedg
#join all the count data togther

subsetQ_11_coded_grower_1 <- full_join(subsetQ_11.2_codedg, subsetQ_11.4_codedg )
#subsetQ_11_coded_grower_1
subsetQ_11_coded_grower <- full_join(subsetQ_11_coded_grower_1, subsetQ_11.6_codedg )
#subsetQ_11_coded_grower

subsetQ_11_coded_grower$Q_11.2_count[is.na(subsetQ_11_coded_grower$Q_11.2_count)] <- 0
subsetQ_11_coded_grower$Q_11.4_count[is.na(subsetQ_11_coded_grower$Q_11.4_count)] <- 0
subsetQ_11_coded_grower$Q_11.6_count[is.na(subsetQ_11_coded_grower$Q_11.6_count)] <- 0
#subsetQ_11_coded_agro[is.na(subsetQ_11_coded_agro)] <- 0 # change NA to zero
#subsetQ_11_coded_grower
subsetQ_11_coded_grower <- filter(subsetQ_11_coded_grower, source != "NA" & source != "c" 
                                       & source != "x" 
                                       & source != "y"
                                       & source != "z" 
                                       & source != "...")
#subsetQ_11_coded_grower                                     

subsetQ_11_coded_grower <- mutate(subsetQ_11_coded_grower, sum_count_sources = (Q_11.2_count + Q_11.4_count + Q_11.6_count)) #count the numbers in each source
#sum(subsetQ_11_coded_grower$sum_count_sources)
#subsetQ_11_coded_grower
subsetQ_11_coded_grower <- mutate(subsetQ_11_coded_grower, 
                                percent_source1 = (Q_11.2_count)/ sum(Q_11.2_count),
                                percent_all_sources = (sum_count_sources)/ sum(subsetQ_11_coded_grower$sum_count_sources))
#subsetQ_11_coded_grower
subsetQ_11_coded_grower <- arrange(subsetQ_11_coded_grower,desc (percent_source1))

#subsetQ_11_coded_grower

subsetQ_11_coded_grower <- mutate(subsetQ_11_coded_grower, 
                                source = fct_relevel(source, c( "Test results", 
                                                                "Agronomist",
                                                                "Farm history/experience",  
                                                                "Yield maps/Data",
                                                                "Industry data, research or agronomy tools", 
                                                                "Supplier info", 
                                                                "Yield modelling/estimates", 
                                                                "Local Trials",
                                                                "Local farming groups & events",
                                                                "Other farmers",  
                                                                "Seasonal economic environment" )))

ggplot(subsetQ_11_coded_grower, aes( source , percent_source1 ))+
  geom_col()+
  #facet_wrap(. ~ Resp_Group)+
  #geom_text(aes(label = percent(signif(percent),1), vjust = -1.0, hjust = 0.5))+
  theme_classic()+
  labs(x= "",
       y = "",
       fill = "",
       title = "Main sources of information or advice for what nutrients (source one only)",
       subtitle = "Growers only",
       caption = "Q) What are your 3 main sources of information or advice for what nutrients you apply and at what rate? 
       ")+
  
  theme(axis.text.x=element_text(angle=45,hjust=1),
        plot.caption = element_text(hjust = 1)) +
  
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits=c(0, 0.5))


ggplot(subsetQ_11_coded_grower, aes( source , percent_all_sources ))+
  geom_col()+
  #facet_wrap(. ~ Resp_Group)+
  #geom_text(aes(label = percent(signif(percent),1), vjust = -1.0, hjust = 0.5))+
  theme_classic()+
  labs(x= "",
       y = "",
       fill = "",
       title = "Main three sources of information or advice for what nutrients",
       subtitle = "Grower only",
       caption = "Q) What are your 3 main sources of information or advice for what nutrients you apply and at what rate? 
       ")+
  
  theme(axis.text.x=element_text(angle=45,hjust=1),
        plot.caption = element_text(hjust = 1)) +
  
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits=c(0, 0.5))


```


Q11.2 11.4 & 11.4Graphed descending order grower and agronomist source 1 only and then combined source 1,2 & 3
Questioned asked to indicate if difference between N P and other nutrients, we have not considered this.
Low response rate most didn't indicate a difference between nutrients.

For Agro response rate was source 1 = 11 NA , source 2 = 14 NA and source 3 = 24
For growers response rate was source 1 = 44 NA , source 2 = 47 NA and source 3 = 57


# **Soil testing** 
This section explores how you use soil testing. If you have NOT done soil testing, please go to page  8.

#### **Question 12**

Grower

Explain your approach to soil testing P, N and other micronutrients ...

* P
* N
* Micronutrients




```{r Q12.1 source of advice grower, echo=FALSE, message=FALSE, warning=TRUE}

headers12_1 <- read_excel("Q12_ Assigning_Category ID_22.10.19.xlsx", 
                       sheet = "Q12.1", col_names=FALSE, range = "B4:E4")

head(headers12_1)

data_q12_1 <- read_excel("Q12_ Assigning_Category ID_22.10.19.xlsx", 
                       sheet = "Q12.1", col_names=FALSE, range = "B5:E174")
names(data_q12_1) <- headers12_1

head(data_q12_1)
data_q12_1 <- mutate(data_q12_1,
                   names_display =case_when(
                     Q_12.1_ID == "1" ~  "Shallow",
                     Q_12.1_ID  == "2" ~  "Cowell P",
                     Q_12.1_ID  == "3" ~  "Deep",
                     Q_12.1_ID  == "4" ~  "All depths",
                     Q_12.1_ID  == "5" ~  "Yield maps",
                     Q_12.1_ID  == "6" ~  "Programs",
                     Q_12.1_ID  == "7" ~  "Combo",
                     Q_12.1_ID  == "Combo (1,5)" ~  "Combo",
                     Q_12.1_ID  == "8" ~  "Don't test",
                     Q_12.1_ID  == "9" ~  "Unspecified/random",
                     Q_12.1_ID  == "0" ~  "NA"))



data_q12_1summary <- filter (data_q12_1, Resp_Group == "Agronomist" & names_display !=  "NA")%>%
  count(names_display) %>% 
  mutate(percent = 
           (freq = n / sum(n))) %>% 
  arrange(desc(percent))



data_q12_1summary 
data_q12_1summary<- mutate(data_q12_1summary, names_display = fct_relevel(names_display, 
                                                                      c("Programs",
                                                                        "Shallow", 
                                                                        "Unspecified/random",
                                                                        "All depths",
                                                                        "Combo",
                                                                        "Yield maps",
                                                                        "Cowell P",
                                                                        "Don't test")))

ggplot(data_q12_1summary, aes(names_display , percent ))+
  geom_col()+
  #facet_wrap(. ~ Resp_Group)+
  #geom_text(aes(label = percent(signif(percent),1), vjust = -1.0, hjust = 0.5))+
  theme_classic()+
  labs(x= "",
       y = "Percent",
       fill = "",
       title = "Explain your approach to soil testing P?",
       subtitle = "Agronomist only",
       caption = "Q) Explain your approach to soil testing P?")+
  theme(axis.text.x=element_text(angle=45,hjust=1),
        plot.caption = element_text(size = 8)) + 
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits=c(0, 0.5))


data_q12_1summary <- filter (data_q12_1, Resp_Group == "Grower" & names_display !=  "NA")%>%
  count(names_display) %>% 
  mutate(percent = 
           (freq = n / sum(n))) %>% 
  arrange(desc(percent))

data_q12_1summary 
data_q12_1summary<- mutate(data_q12_1summary, names_display = fct_relevel(names_display, 
                                                                      c("Programs",
                                                                        "Shallow", 
                                                                        "Unspecified/random",
                                                                        "All depths",
                                                                        "Combo",
                                                                        "Yield maps",
                                                                        "Cowell P",
                                                                        "Don't test",
                                                                        "Deep")))

ggplot(data_q12_1summary, aes(names_display , percent ))+
  geom_col()+
  #facet_wrap(. ~ Resp_Group)+
  #geom_text(aes(label = percent(signif(percent),1), vjust = -1.0, hjust = 0.5))+
  theme_classic()+
  labs(x= "",
       y = "Percent",
       fill = "",
       title = "Explain your approach to soil testing P?",
       subtitle = "Grower only",
       caption = "Q) Explain your approach to soil testing P?")+
  theme(axis.text.x=element_text(angle=45,hjust=1),
        plot.caption = element_text(size = 8)) + 
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits=c(0, 0.5))


###################################################################################################################
############################## Q12.2###############################################################################

headers12_2 <- read_excel("Q12_ Assigning_Category ID_22.10.19.xlsx", 
                       sheet = "Q12.2", col_names=FALSE, range = "B4:E4")

head(headers12_2)

data_q12_2 <- read_excel("Q12_ Assigning_Category ID_22.10.19.xlsx", 
                       sheet = "Q12.2", col_names=FALSE, range = "B5:E174")
names(data_q12_2) <- headers12_2

head(data_q12_2)
data_q12_2 <- mutate(data_q12_2,
                   names_display =case_when(
                     Q_12.2_ID == "1" ~  "Shallow",
                     Q_12.2_ID  == "2" ~  "Cowell P",
                     Q_12.2_ID  == "3" ~  "Deep",
                     Q_12.2_ID  == "4" ~  "All depths",
                     Q_12.2_ID  == "5" ~  "Yield maps",
                     Q_12.2_ID  == "6" ~  "Programs",
                     Q_12.2_ID  == "7" ~  "Combo",
                     Q_12.2_ID  == "Combo (1,5)" ~  "Combo",
                     Q_12.2_ID  == "8" ~  "Don't test",
                     Q_12.2_ID  == "9" ~  "Unspecified/random",
                     Q_12.2_ID  == "0" ~  "NA"))



data_q12_2summary <- filter (data_q12_2, Resp_Group == "Agronomist" & names_display !=  "NA")%>%
  count(names_display) %>% 
  mutate(percent = 
           (freq = n / sum(n))) %>% 
  arrange(desc(percent))



data_q12_2summary 
data_q12_2summary<- mutate(data_q12_2summary, names_display = fct_relevel(names_display, 
                                                                      c("Deep",
                                                                        "All depths",
                                                                        "Programs",
                                                                        "Unspecified/random",
                                                                        "Don't test",
                                                                        "Yield maps",
                                                                        "Combo",
                                                                        "Shallow")))
                                                                        #"Cowell P"


ggplot(data_q12_2summary, aes(names_display , percent ))+
  geom_col()+
  #facet_wrap(. ~ Resp_Group)+
  #geom_text(aes(label = percent(signif(percent),1), vjust = -1.0, hjust = 0.5))+
  theme_classic()+
  labs(x= "",
       y = "Percent",
       fill = "",
       title = "Explain your approach to soil testing N?",
       subtitle = "Agronomist only",
       caption = "Q) Explain your approach to soil testing N?")+
  theme(axis.text.x=element_text(angle=45,hjust=1),
        plot.caption = element_text(size = 8)) + 
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits=c(0, 0.5))


data_q12_2summary <- filter (data_q12_2, Resp_Group == "Grower" & names_display !=  "NA")%>%
  count(names_display) %>% 
  mutate(percent = 
           (freq = n / sum(n))) %>% 
  arrange(desc(percent))

data_q12_2summary 
data_q12_2summary<- mutate(data_q12_2summary, names_display = fct_relevel(names_display, 
                                                                          c("Deep",
                                                                            "All depths",
                                                                            "Programs",
                                                                            "Unspecified/random",
                                                                            "Don't test",
                                                                            "Yield maps",
                                                                            "Combo",
                                                                            "Shallow")))
#"Cowell P"


ggplot(data_q12_2summary, aes(names_display , percent ))+
  geom_col()+
  #facet_wrap(. ~ Resp_Group)+
  #geom_text(aes(label = percent(signif(percent),1), vjust = -1.0, hjust = 0.5))+
  theme_classic()+
  labs(x= "",
       y = "Percent",
       fill = "",
       title = "Explain your approach to soil testing N?",
       subtitle = "Grower only",
       caption = "Q) Explain your approach to soil testing N?")+
  theme(axis.text.x=element_text(angle=45,hjust=1),
        plot.caption = element_text(size = 8)) + 
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits=c(0, 0.5))



##########################################################################################
############### Q12_3############################################################

headers12_3 <- read_excel("Q12_ Assigning_Category ID_22.10.19.xlsx", 
                       sheet = "Q12.3", col_names=FALSE, range = "B4:E4")

head(headers12_3)

data_q12_3 <- read_excel("Q12_ Assigning_Category ID_22.10.19.xlsx", 
                       sheet = "Q12.3", col_names=FALSE, range = "B5:E174")
names(data_q12_3) <- headers12_3



head(data_q12_3)
data_q12_3 <- mutate(data_q12_3,
                   names_display =case_when(
                     Q_12.3_ID == "1" ~  "Shallow",
                     Q_12.3_ID  == "2" ~  "NA",
                     Q_12.3_ID  == "3" ~  "NA",
                     Q_12.3_ID  == "4" ~  "All depths",
                     Q_12.3_ID  == "5" ~  "Yield maps",
                     Q_12.3_ID  == "6" ~  "Programs",
                     Q_12.3_ID  == "7" ~  "Combo",
                     Q_12.3_ID  == "Combo (1,5)" ~  "Combo",
                     Q_12.3_ID  == "8" ~  "Don't test",
                     Q_12.3_ID  == "9" ~  "Unspecified/random",
                     Q_12.3_ID  == "0" ~  "NA",
                     Q_12.3_ID  == "10" ~  "Plant",
                     Q_12.3_ID  == "11" ~  "Soil & Plant"))


data_q12_3summary <- filter (data_q12_3, Resp_Group == "Agronomist" & names_display !=  "NA")%>%
  count(names_display) %>% 
  mutate(percent = 
           (freq = n / sum(n))) %>% 
  arrange(desc(percent))

data_q12_3summary 
data_q12_3summary<- mutate(data_q12_3summary, names_display = fct_relevel(names_display, 
                                                                          c("Plant",
                                                                            "Soil & Plant",
                                                                            "Unspecified/random",
                                                                            "Programs",
                                                                            "All depths",
                                                                            "Don't test",
                                                                            "Shallow", 
                                                                            "Combo")))
                                                                            #"Yield maps"


ggplot(data_q12_3summary, aes(names_display , percent ))+
  geom_col()+
  #facet_wrap(. ~ Resp_Group)+
  #geom_text(aes(label = percent(signif(percent),1), vjust = -1.0, hjust = 0.5))+
  theme_classic()+
  labs(x= "",
       y = "Percent",
       fill = "",
       title = "Explain your approach to soil testing micronutrients?",
       subtitle = "Agronomist only",
       caption = "Q) Explain your approach to soil testing micronutrients?")+
  theme(axis.text.x=element_text(angle=45,hjust=1),
        plot.caption = element_text(size = 8)) + 
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits=c(0, 0.5))


data_q12_3summary <- filter (data_q12_3, Resp_Group == "Grower" & names_display !=  "NA")%>%
  count(names_display) %>% 
  mutate(percent = 
           (freq = n / sum(n))) %>% 
  arrange(desc(percent))

data_q12_3summary 
data_q12_3summary<- mutate(data_q12_3summary, names_display = fct_relevel(names_display, 
                                                                          c("Plant",
                                                                            "Soil & Plant",
                                                                            "Unspecified/random",
                                                                            "Programs",
                                                                            #"All depths",
                                                                            "Don't test",
                                                                            #"Shallow", 
                                                                            "Combo",
                                                                            "Yield maps")))
#

ggplot(data_q12_3summary, aes(names_display , percent ))+
  geom_col()+
  #facet_wrap(. ~ Resp_Group)+
  #geom_text(aes(label = percent(signif(percent),1), vjust = -1.0, hjust = 0.5))+
  theme_classic()+
  labs(x= "",
       y = "Percent",
       fill = "",
       title = "Explain your approach to soil testing micronutrients?",
       subtitle = "Grower only",
       caption = "Q) Explain your approach to soil testing micronutrients?")+
  theme(axis.text.x=element_text(angle=45,hjust=1),
        plot.caption = element_text(size = 8)) + 
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits=c(0, 0.5))

```

##### Question 12
Explain your approach to soil testing P, N and other micronutrients ...

Graphed in descending order firstly Agronomist and then Grower responses to testing approach foe the 3 nutrient groups

* P
* N
* Micronutrients
Need to check this is best way to present!


#### **Question 13** Check over output
Agronomist

Can you please provide some specific information on ..

* What % of your clients soil tested in 2018? (any testing)
* What % of your clients tested for N in 2018? (N)
* What % of your clients tested for N to at least 60cm in 2018?
* What % of your clients tested for P in 2018? (P)

Note for this question agronomist were asked to nominate the bin.

* 0
* 10-15%
* 15-20%
* 5-10%
* 50 -100%

Grower

Can you please provide some specific information on ..

* What % of  your cropped land was soil tested in 2018 (any testing)
* What % of your cropped land was tested for N in 2018? (N)
* What % of your cropped land was tested for N to at least 60cm in 2018?
* What % of your cropped land was tested for P in 2018? (P)

Note for this question agronomist were asked to nominate the bin.

* 0
* 10-15%
* 15-20%
* 5-10%
* 50 -100%

Note the data set has NA these are not displayed in the graphs
But they have been included in the analysis for the counts.

```{r Q13 data work up and DT summary, echo=FALSE}

data_agro <- filter(data, Resp_Group == "Agronomist" )

#check out if we have any missing data for this question
  #data_agro %>% group_by(Resp_Group) %>%
  #         summarise(sum(is.na(Q_13.1)))

data_grower <- filter(data, Resp_Group == "Grower" )

### any test do argo and grower sep and then join

Q13_percent_testing_2018_agro <- data_agro %>%
  filter(!is.na(Q_13.1)) %>% #this removes the na from the anlaysis
  group_by( Q_13.1 ) %>%
  summarise(n = n()) %>%
  mutate(percent = (freq = n / sum(n)),
         type = "percent_testing_2018",
         Resp_Group = "Agronomist")




Q13_percent_testing_2018_agro <- Q13_percent_testing_2018_agro %>%
  select(n,
        percent,
        type,
        bins = Q_13.1,
        Resp_Group)

Q13_percent_testing_2018_grower <- data_grower %>%
  filter(!is.na(Q_13.1)) %>% #this removes the na from the anlaysis
  group_by( Q_13.1 ) %>%
  summarise(n = n()) %>%
  mutate(percent = (freq = n / sum(n)),
         type = "percent_testing_2018",
         Resp_Group = "Grower")
Q13_percent_testing_2018_grower <- Q13_percent_testing_2018_grower %>%
  select(n,
        percent,
        type,
        bins = Q_13.1,
        Resp_Group)

Q13_percent_testing_2018 <- rbind(Q13_percent_testing_2018_agro, Q13_percent_testing_2018_grower)
#tail(Q13_percent_testing_2018)

#####  N test do agro and grower sep and then join

Q13_percent_N_testing_2018_argo <- data_agro %>%
  filter(!is.na(Q_13.2)) %>% #this removes the na from the anlaysis
  group_by(  Q_13.2  ) %>%
  summarise(n = n()) %>%
  mutate(percent =(freq = n / sum(n)),
         type = "percent_N_testing_2018",
         Resp_Group = "Agronomist")
Q13_percent_N_testing_2018_argo <- Q13_percent_N_testing_2018_argo %>%
  select(n,
         percent,
         type,
         bins = Q_13.2,
         Resp_Group)
Q13_percent_N_testing_2018_grower <- data_grower %>%
  filter(!is.na(Q_13.2)) %>% #this removes the na from the anlaysis
  group_by(  Q_13.2  ) %>%
  summarise(n = n()) %>%
  mutate(percent =(freq = n / sum(n)),
         type = "percent_N_testing_2018",
         Resp_Group = "Grower")
Q13_percent_N_testing_2018_grower <- Q13_percent_N_testing_2018_grower %>%
  select(n,
         percent,
         type,
         bins = Q_13.2,
         Resp_Group)

Q13_percent_N_testing_2018 <- rbind(Q13_percent_N_testing_2018_argo, Q13_percent_N_testing_2018_grower)
#tail(Q13_percent_N_testing_2018)


#### P test do agro and grower sep and then join (sorry its messy!)
Q13_percent_P_testing_2018_argo <- data_agro %>%
  filter(!is.na(Q_13.4)) %>% #this removes the na from the anlaysis
  group_by(Q_13.4) %>%
  summarise(n = n()) %>%
  mutate(percent =(freq = n / sum(n)),
         type = "percent_P_testing_2018",
         Resp_Group = "Agronomist")
Q13_percent_P_testing_2018_argo <- Q13_percent_P_testing_2018_argo %>%
  select(n,
         percent,
         type,
         bins = Q_13.4,
         Resp_Group)
temp <- rbind(Q13_percent_testing_2018,
              Q13_percent_N_testing_2018)

temp <- rbind(temp,
              Q13_percent_P_testing_2018_argo)


Q13_percent_P_testing_2018_grower <- data_grower %>%
  filter(!is.na(Q_13.4)) %>% #this removes the na from the anlaysis
  group_by(  Q_13.4  ) %>%
  summarise(n = n()) %>%
  mutate(percent =(freq = n / sum(n)),
         type = "percent_P_testing_2018",
         Resp_Group = "Grower")
Q13_percent_P_testing_2018_grower <- Q13_percent_P_testing_2018_grower %>%
  select(n,
         percent,
         type,
         bins = Q_13.4,
         Resp_Group)

head(Q13_percent_P_testing_2018_grower)

Q13_percent_testing <- rbind(temp,
              Q13_percent_P_testing_2018_grower)


#print(Q13_percent_testing)

Q13_percent_testing <- select(Q13_percent_testing,
                              type,
                              bins,
                              percent, n, Resp_Group)      
#head(Q13_percent_testing) 


labels <- c(percent_N_testing_2018 = "N", 
            percent_P_testing_2018 = "P",
            percent_testing_2018 = "testing")


#head(Q12_percent_testing)
Q13_percent_testing_for_table <- mutate(Q13_percent_testing,
                                        percent1 = round(percent*100,2),
                                        label_name = case_when(
                                          type == "percent_N_testing_2018" ~ "N",
                                          type == "percent_P_testing_2018" ~ "P",
                                          type == "percent_testing_2018" ~ "any testing")) %>% 
                                select(label_name, bins, percent1, Resp_Group )


#head(Q13_percent_testing_for_table)


#filter(Q13_percent_testing_for_table, bins != "NA") %>% 
#  datatable(colnames = c("testing for", "bins", "percentage of testing done", "Resp_Group" ))


```

```{r Q13 graphs , echo=FALSE}

caption_agro <- c(
"Q) What % of your clients soil tested in 2018?
Q) What % of your clients tested for N in 2018?
Q) What % of your clients tested for P in 2018?")

caption_grower <- c(
"Q) What % of  your cropped land was soil tested in 2018?
Q) What % of your cropped land was tested for N in 2018?
Q) What % of your cropped land was tested for P in 2018?")


#get the correct order for my labeles
 Q13_percent_testing <- mutate(Q13_percent_testing,
                                bin_as_factors = case_when(
                                  bins == "0" ~ 0,
                                  bins == "5-10%" ~ 5,
                                  bins == "10-15%" ~ 10,
                                  bins == "15-20%" ~ 15,
                                  bins == "20-50%" ~ 20,
                                  bins == "50-100%" ~ 50
                                ))
  Q13_percent_testing$bin_as_factors <- factor(Q13_percent_testing$bin_as_factors,
                                        levels=c(0,5,10,15,20,50),
                                        labels=c("0","5-10%","10-15%","15-20%", "20-50%", "50-100%")) 
  datatable(Q13_percent_testing)
  filter(Q13_percent_testing, bin_as_factors != "NA" &
           Resp_Group == "Agronomist") %>% 
    ggplot( aes(bin_as_factors, percent))+
    geom_col()+
    #geom_text(aes(label = percent(signif(percent),1), vjust = -1.0, hjust = 0.5))+
    theme_classic()+
    facet_wrap(. ~ type, labeller=labeller(type = labels)) +  
    labs(x= "bins",
         y = "",
         title = "In 2018 what % of your clients tested...",
         subtitle = "Agronomist",
         caption = caption_agro)+
    theme(axis.text.x=element_text(angle=90,hjust=1),
          plot.caption = element_text(size = 8, hjust = 0))+
    scale_y_continuous(labels = scales::percent)

  
  
  filter(Q13_percent_testing, bin_as_factors != "NA" &
           Resp_Group == "Grower") %>% 
    ggplot( aes(bin_as_factors, percent))+
    geom_col()+
    #geom_text(aes(label = percent(signif(percent),1), vjust = -1.0, hjust = 0.5))+
    theme_classic()+
    facet_wrap(. ~ type, labeller=labeller(type = labels)) +  
    labs(x= "bins",
         y = "",
         title = "In 2018 what % of your cropped land was tested...",
         subtitle = "Grower",
         caption = caption_grower)+
    theme(axis.text.x=element_text(angle=90,hjust=1),
          plot.caption = element_text(size = 8, hjust = 0))+
    scale_y_continuous(labels = scales::percent)
```

Try to take out the percentage of percentage graph

Can try:

* Agronomists with more than half of clients soil testing in 2018 
* Agronomists with less than 20% of clients  soil testing in 2018 
* Agronomists with no clients soil testing in 2018

* Growers with more than half of clients soil testing in 2018 
* Growers with less than 20% of clients  soil testing in 2018 
* Growers with no clients soil testing in 2018

Note that for this analysis I have removed the NA values before re classing the bins
I have another bin called 'other' which is used to get the percentage.
This just mean that I am calculating the percentage based on all the respondents (not the NA)
In the table you can see the bin called other, but I have not displayed it in the graphs.

Hope this is clear - not sure if this is what you were after?

```{r Q13 graphs other options , echo=FALSE}



subset_soil_testQ_13 <- select(data, Resp_Group, Q_13.1, Q_13.2, Q_13.4)
subset_soil_testQ_13 <- filter(subset_soil_testQ_13, Q_13.1 != "NA") #this takes out all the na
#Recode to only have 50% or more

#table(subset_soil_testQ_13)
subset_soil_testQ_13 <- mutate(subset_soil_testQ_13,
                              recode_13.1 = case_when(
                                Q_13.1 == "50-100%" ~ "more than half",
                                #Q_13.1 == "0" ~ "less than 20%",
                                Q_13.1 == "10-15%" ~ "less than 20%",
                                Q_13.1 == "15-20%" ~ "less than 20%",
                                Q_13.1 == "0" ~ "Zero",
                                 TRUE  ~ "other"
                                ))

subset_soil_testQ_13 <- mutate(subset_soil_testQ_13,
                               recode_13.2 = case_when(
                                 Q_13.2 == "50-100%" ~ "more than half",
                                 #Q_13.2 == "0" ~ "less than 20%",
                                 Q_13.2 == "10-15%" ~ "less than 20%",
                                 Q_13.2 == "15-20%" ~ "less than 20%",
                                 Q_13.2 == "0" ~ "Zero",
                                  TRUE  ~ "other"
                               ))

subset_soil_testQ_13 <- mutate(subset_soil_testQ_13,
                               recode_13.4 = case_when(
                                 Q_13.4 == "50-100%" ~ "more than half",
                                 #Q_13.4 == "0" ~ "less than 20%",
                                 Q_13.4 == "10-15%" ~ "less than 20%",
                                 Q_13.4 == "15-20%" ~ "less than 20%",
                                 Q_13.4 == "0" ~ "Zero",
                                  TRUE  ~ "other"
                               ))
#head(subset_soil_testQ_13)
subset_soil_testQ_13_agro <- filter(subset_soil_testQ_13, Resp_Group == "Agronomist" )
subset_soil_testQ_13_grower <- filter(subset_soil_testQ_13, Resp_Group == "Grower" )

#any test agro and grower sep and then join
subset_soil_testQ_13_agro_test <- subset_soil_testQ_13_agro %>%  
  group_by(   recode_13.1  ) %>%
  summarise(n = n()) %>%
  mutate(percent =(freq = n / sum(n)),
         type = "percent_testing_2018",
         Resp_Group = "Agronomist")
subset_soil_testQ_13_agro_test <- subset_soil_testQ_13_agro_test %>%
  select(n,
         percent,
         type,
         bins = recode_13.1,
         Resp_Group)

subset_soil_testQ_13_grower_test <- subset_soil_testQ_13_grower %>%  
  group_by(   recode_13.1  ) %>%
  summarise(n = n()) %>%
  mutate(percent =(freq = n / sum(n)),
         type = "percent_testing_2018",
         Resp_Group = "Grower")
subset_soil_testQ_13_grower_test <- subset_soil_testQ_13_grower_test %>%
  select(n,
         percent,
         type,
         bins = recode_13.1,
         Resp_Group)

subset_soil_testQ_13_test <- rbind(subset_soil_testQ_13_grower_test, subset_soil_testQ_13_agro_test)


#N test agro and grower sep and then join
subset_soil_NQ_13_agro_test <- subset_soil_testQ_13_agro %>%  
  group_by(   recode_13.2  ) %>%
  summarise(n = n()) %>%
  mutate(percent =(freq = n / sum(n)),
         type = "percent_N_testing_2018",
         Resp_Group = "Agronomist")
subset_soil_NQ_13_agro_test <- subset_soil_NQ_13_agro_test %>%
  select(n,
         percent,
         type,
         bins = recode_13.2,
         Resp_Group)

subset_soil_testNQ_13_grower_test <- subset_soil_testQ_13_grower %>%  
  group_by(   recode_13.2  ) %>%
  summarise(n = n()) %>%
  mutate(percent =(freq = n / sum(n)),
         type = "percent_N_testing_2018",
         Resp_Group = "Grower")
subset_soil_testNQ_13_grower_test <- subset_soil_testNQ_13_grower_test %>%
  select(n,
         percent,
         type,
         bins = recode_13.2,
         Resp_Group)

subset_soil_N_testQ_13_test <- rbind(subset_soil_testNQ_13_grower_test, subset_soil_NQ_13_agro_test)


#P test agro and grower sep and then join
subset_soil_PQ_13_agro_test <- subset_soil_testQ_13_agro %>%  
  group_by(   recode_13.4  ) %>%
  summarise(n = n()) %>%
  mutate(percent =(freq = n / sum(n)),
         type = "percent_P_testing_2018",
         Resp_Group = "Agronomist")
subset_soil_PQ_13_agro_test <- subset_soil_PQ_13_agro_test %>%
  select(n,
         percent,
         type,
         bins = recode_13.4,
         Resp_Group)

subset_soil_testPQ_13_grower_test <- subset_soil_testQ_13_grower %>%  
  group_by(   recode_13.4  ) %>%
  summarise(n = n()) %>%
  mutate(percent =(freq = n / sum(n)),
         type = "percent_P_testing_2018",
         Resp_Group = "Grower")
subset_soil_testPQ_13_grower_test <- subset_soil_testPQ_13_grower_test %>%
  select(n,
         percent,
         type,
         bins = recode_13.4,
         Resp_Group)

subset_soil_P_testQ_13_test <- rbind(subset_soil_testPQ_13_grower_test, subset_soil_PQ_13_agro_test)
subset_soil_P_testQ_13_test
subset_soil_testQ_13_narrow <- rbind(subset_soil_testQ_13_test, subset_soil_N_testQ_13_test, subset_soil_P_testQ_13_test)

# get the format I am after I need to make each data frame wide and then join togther
subset_soil_testQ_13_test_wide <- spread(subset_soil_testQ_13_test, key = type, value = percent) %>% mutate(id= paste0(Resp_Group, "_", bins))
subset_soil_N_testQ_13_test_wide <- spread(subset_soil_N_testQ_13_test, key = type, value = percent)%>% mutate(id= paste0(Resp_Group, "_", bins))
subset_soil_P_testQ_13_test_wide <- spread(subset_soil_P_testQ_13_test, key = type, value = percent)%>% mutate(id= paste0(Resp_Group, "_", bins))


subset_soil_N_P_Any_Q_13_wide <- left_join(subset_soil_testQ_13_test_wide, 
                                           subset_soil_N_testQ_13_test_wide,
                                           subset_soil_P_testQ_13_test_wide,
                                           by = "id")


subset_soil_N_P_Any_Q_13_wide <-  subset_soil_testQ_13_test_wide %>%
                                  left_join(subset_soil_N_testQ_13_test_wide, by='id') %>%
                                  left_join(subset_soil_P_testQ_13_test_wide, by='id')

#print(subset_soil_N_P_Any_Q_13_wide$percent_P_testing_2018)
subset_soil_N_P_Any_Q_13_wide <- select( subset_soil_N_P_Any_Q_13_wide,
                                         bins = bins.x,
                                         Resp_Group = Resp_Group.x,
                                         percent_testing_2018,
                                         percent_N_testing_2018,
                                         percent_P_testing_2018)

subset_soil_N_P_Any_Q_13_wide <- mutate_if(subset_soil_N_P_Any_Q_13_wide,
                                           is.double, round,2)

datatable(subset_soil_N_P_Any_Q_13_wide) %>% 
  formatPercentage(c("percent_testing_2018", "percent_N_testing_2018", "percent_P_testing_2018"))


filter(subset_soil_testQ_13_narrow, bins != "other" &
           Resp_Group == "Grower") %>% 
    ggplot( aes(bins, percent))+
    geom_col()+
    #geom_text(aes(label = percent(signif(percent),1), vjust = -1.0, hjust = 0.5))+
    theme_classic()+
    facet_wrap(. ~ type, labeller=labeller(type = labels)) +  
    labs(x= "bins",
         y = "",
         title = "In 2018 what % of your cropped land was tested...",
         subtitle = "Grower",
         caption = caption_grower)+
    theme(axis.text.x=element_text(angle=90,hjust=1),
          plot.caption = element_text(size = 8, hjust = 0))+
    scale_y_continuous(labels = scales::percent)

filter(subset_soil_testQ_13_narrow, bins != "other" &
           Resp_Group == "Agronomist") %>% 
    ggplot( aes(bins, percent))+
    geom_col()+
    #geom_text(aes(label = percent(signif(percent),1), vjust = -1.0, hjust = 0.5))+
    theme_classic()+
    facet_wrap(. ~ type, labeller=labeller(type = labels)) +  
    labs(x= "bins",
         y = "",
         title = "In 2018 what % of your cropped land was tested...",
         subtitle = "Agronomist",
         caption = caption_grower)+
    theme(axis.text.x=element_text(angle=90,hjust=1),
          plot.caption = element_text(size = 8, hjust = 0))+
    scale_y_continuous(labels = scales::percent)

```


#### **Question 14 N**

Grower
Which tests do you currently use for soil N testing?

* Nitrogen 1 - Type of test
* Nitrogen 1 - Frequency (times per season)
* Nitrogen 1 - How many representative samples per paddock
* Nitrogen 2 - Type of test
* Nitrogen 2 - Frequency (times per season)
* Nitrogen 2 - How many representative samples per paddock
* Nitrogen 3 - Type of test
* Nitrogen 3 - Frequency (times per season)
* Nitrogen 3 - How many representative samples per paddock
* How frequently are paddocks tested i.e. every 3 years, every 5 years ... other?


```{r Q14 data work up, include=FALSE}

data
data$Q_14.1.1
data$Q_14.1.3

### use this this to count how many we have for test 1=organic carbon
subsetQ_14.1 <- select(data, Q_14.1.1, Q_14.1.3, Resp_Group, `Respondent ID`)

head(subsetQ_14.1)


sum(is.na(subsetQ_14.1$Q_14.1.1)) #number of NA in this Question 14.1.1
sum(is.na(subsetQ_14.1$Q_14.1.3)) #number of NA in this Question 14.1.3


subsetQ_14.1_OC <- filter(subsetQ_14.1,
                                     Q_14.1.1 == "Organic Carbon")

#tail(subsetQ_14.1_coded_agro_OC)

subsetQ_14.1_MN <- filter(subsetQ_14.1,
                                     Q_14.1.1 == "Mineral N (Nitrate/Ammonium)")
subsetQ_14.1_TN <- filter(subsetQ_14.1,
                                     Q_14.1.1 == "Total N")


###### Type of test 2 #### 
data$Q_14.2.1
data$Q_14.2.3

### use this this to count how many we have for test 1=organic carbon
subsetQ_14.2<- select(data, Q_14.2.1, Q_14.2.3, Resp_Group, `Respondent ID`) 

head(subsetQ_14.2)

sum(is.na(subsetQ_14.2$Q_14.2.1)) #number of NA in this Question 14.2.1
sum(is.na(subsetQ_14.2$Q_14.2.3)) #number of NA in this Question 14.2.3

#tail(subsetQ_14.2_coded_agro_OC)

subsetQ_14.2_OC <- filter(subsetQ_14.2,
                                     Q_14.2.1 == "Organic Carbon")
subsetQ_14.2_MN <- filter(subsetQ_14.2,
                                     Q_14.2.1 == "Mineral N (Nitrate/Ammonium)")
subsetQ_14.2_TN <- filter(subsetQ_14.2,
                                     Q_14.2.1 == "Total N")

###### Type of test 3 #### 
data$Q_14.3.1
data$Q_14.3.3

### use this this to count how many we have for test 1=organic carbon
subsetQ_14.3 <- select(data, Q_14.3.1, Q_14.3.3, Resp_Group, `Respondent ID`) 

head(subsetQ_14.3)

sum(is.na(subsetQ_14.3$Q_14.3.1)) #number of NA in this Question 14.3.1
sum(is.na(subsetQ_14.3$Q_14.3.3)) #number of NA in this Question 14.3.3

#tail(subsetQ_14.3_OC)

subsetQ_14.3_OC <- filter(subsetQ_14.3,
                                     Q_14.3.1 == "Organic Carbon")
subsetQ_14.3_MN <- filter(subsetQ_14.3,
                                     Q_14.3.1 == "Mineral N (Nitrate/Ammonium)")
subsetQ_14.3_TN <- filter(subsetQ_14.3,
                                     Q_14.3.1 == "Total N")

###Join 3 tests OC
subsetQ_14.1_OC
subsetQ_14.2_OC
subsetQ_14.3_OC

#remane clm headings

colnames(subsetQ_14.1_OC)[1] <- "Q_14"
colnames(subsetQ_14.1_OC)[2] <- "Q_14_freq"

colnames(subsetQ_14.2_OC)[1] <- "Q_14"
colnames(subsetQ_14.2_OC)[2] <- "Q_14_freq"


colnames(subsetQ_14.3_OC)[1] <- "Q_14"
colnames(subsetQ_14.3_OC)[2] <- "Q_14_freq"


Q14_OC <-bind_rows(subsetQ_14.1_OC, subsetQ_14.2_OC, subsetQ_14.3_OC)

###Join 3 tests total N
subsetQ_14.1_TN
subsetQ_14.2_TN
subsetQ_14.3_TN

#remane clm headings

colnames(subsetQ_14.1_TN)[1] <- "Q_14"
colnames(subsetQ_14.1_TN)[2] <- "Q_14_freq"

colnames(subsetQ_14.2_TN)[1] <- "Q_14"
colnames(subsetQ_14.2_TN)[2] <- "Q_14_freq"


colnames(subsetQ_14.3_TN)[1] <- "Q_14"
colnames(subsetQ_14.3_TN)[2] <- "Q_14_freq"


Q14_TN <-bind_rows(subsetQ_14.1_TN, subsetQ_14.2_TN, subsetQ_14.3_TN)

Q14_TN

###Join 3 tests Mineral M
subsetQ_14.1_MN
subsetQ_14.2_MN
subsetQ_14.3_MN

#remane clm headings

colnames(subsetQ_14.1_MN)[1] <- "Q_14"
colnames(subsetQ_14.1_MN)[2] <- "Q_14_freq"

colnames(subsetQ_14.2_MN)[1] <- "Q_14"
colnames(subsetQ_14.2_MN)[2] <- "Q_14_freq"


colnames(subsetQ_14.3_MN)[1] <- "Q_14"
colnames(subsetQ_14.3_MN)[2] <- "Q_14_freq"


Q14_MN <-bind_rows(subsetQ_14.1_MN, subsetQ_14.2_MN, subsetQ_14.3_MN)
# NEED to add colomn for # samples per paddock
####what depth ??
Q14_MN
####what depth ??
subsetQ14_MN<- Q14_MN %>%
  filter(!is.na(Q_14)) %>%
  group_by(Resp_Group) %>% 
  count(Q_14_freq) %>% 
  mutate(percent = round(
    (freq = n / sum(n)),2))


subsetQ14_OC <- Q14_OC %>% 
  filter(!is.na(Q_14)) %>%
  group_by(Resp_Group) %>% 
  count(Q_14_freq) %>% 
  mutate(percent = round(
    (freq = n / sum(n)),2))

subsetQ14_TN <- Q14_TN %>% 
  filter(!is.na(Q_14)) %>%
  group_by(Resp_Group) %>% 
  count(Q_14_freq) %>% 
  mutate(percent = round(
    (freq = n / sum(n)),2))

subsetQ14_MN
subsetQ14_OC
subsetQ14_TN

###join df with test
Q14_MN
Q14_OC
Q14_TN

Q14_all_test <- bind_rows(Q14_MN, Q14_OC, Q14_TN)

Q14_all_test

# filter out NA? no need as by asking for resposes to MN, OC & TN has automatically filtered out na#######
subsetQ14_All_agro_grower <- Q14_all_test %>% 
  # filter(!is.na(Q_14)) %>%
  group_by(Resp_Group) %>% 
  count(Q_14) %>% 
  mutate(percent = round(
    (freq = n / sum(n)),2))

subsetQ14_All_agro_grower

# filter out NA in Q14_freq ######
subsetQ14_All_agro_grower <- Q14_all_test %>% 
  filter(!is.na(Q_14_freq)) %>%
  group_by(Resp_Group) %>% 
  count(Q_14_freq) %>% 
  mutate(percent = round(
    (freq = n / sum(n)),2))

subsetQ14_All_agro_grower

Q14_all_test

subsetQ14_All_agro_grower <- Q14_all_test %>% 
  filter(!is.na(Q_14_freq)) %>%
  group_by(Resp_Group, Q_14) %>% 
  count(Q_14_freq) %>% 
  mutate(percent = round(
    (freq = n / sum(n)),2))


subsetQ14_All_agro_grower$Q_14_freq <- factor(subsetQ14_All_agro_grower$Q_14_freq,levels = c("0-5",  "5-10", "10-15", 
                                                "15-20", "20-25",  "25-30",  "greater than 30"))

                         
```


```{r Q14 data graphs, echo=FALSE}


ggplot(subsetQ14_All_agro_grower, aes (x = Q_14_freq, y = percent))+
  geom_col()+
  #geom_text(aes(label = percent), vjust = -1.0, hjust = 0.5)+
  facet_wrap( Resp_Group ~ Q_14)+
  theme_classic()+
  labs(x= "Samples per paddock",
       y = "",
       title = "Frequency of test",
       subtitle = "",
       caption = "Q)  Which tests do you currently use for your soil N testing?")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8)) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 5L)) 


ggplot(subsetQ14_All_agro_grower, aes (x = Q_14_freq, y = n))+
  geom_col()+
  #geom_text(aes(label = percent), vjust = -1.0, hjust = 0.5)+
  facet_wrap( Resp_Group ~ .)+
  theme_classic()+
  labs(x= "Samples per paddock",
       y = "number of resp",
       title = "Frequency of test",
       subtitle = "",
       caption = "Q)  Which tests do you currently use for your soil N testing?")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8)) #+
  #scale_y_continuous(labels = scales::percent_format(accuracy = 5L)) 


ggplot(subsetQ14_All_agro_grower, aes (x = Q_14_freq, y = n))+
  geom_col()+
  #geom_text(aes(label = percent), vjust = -1.0, hjust = 0.5)+
  facet_wrap( Q_14 ~ .)+
  theme_classic()+
  labs(x= "Samples per paddock",
       y = "number of resp",
       title = "Frequency of test",
       subtitle = "",
       caption = "Q)  Which tests do you currently use for your soil N testing?")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8)) #+
  #scale_y_continuous(labels = scales::percent_format(accuracy = 5L)) 



ggplot(subsetQ14_All_agro_grower, aes (x = Q_14_freq, y = n))+
  geom_col()+
  #geom_text(aes(label = percent), vjust = -1.0, hjust = 0.5)+
  #facet_wrap( Q_14 ~ .)+
  theme_classic()+
  labs(x= "Samples per paddock",
       y = "number of resp",
       title = "Frequency of test",
       subtitle = "Total of all tests and respondents",
       caption = "Q)  Which tests do you currently use for your soil N testing?")+
  theme(axis.text.x=element_text(angle=90,hjust=1),
        plot.caption = element_text(size = 8)) 
  #scale_y_continuous(labels = scales::percent_format(accuracy = 5L)) 


```


#### **Question 15 P**
grower
Which tests do you use for P tests?

* Phosphorus 1 - Type of test
* Phosphorus 1 - Frequency (times per season)
* Phosphorus 1 - How many representative samples per paddock
* Phosphorus 2 - Type of test
* Phosphorus 2 - Frequency (times per season)
* Phosphorus 2 - How many representative samples per paddock
* Phosphorus 3 - Type of test
* Phosphorus 3 - Frequency (times per season)
* Phosphorus 3 - How many representative samples per paddock
* Phosphorus 4 - Type of test
* Phosphorus 4 - Frequency (times per season)
* Phosphorus 4 - How many representative samples per paddock
* Phosphorus 5 - Type of test
* Phosphorus 5 - Frequency (times per season)
* Phosphorus 5 - How many representative samples per paddock
* How frequently are your clients paddocks tested i.e. every 3 years, every 5 years ... other?

#### **Question 16 Potassium**
What tests do you use for Potassium testing ...

* Potassium 1 - Type of test
* Potassium 1 - Frequency (times per season)
* Potassium 1 - How many representative samples per paddock
* Potassium 2 - Type of test
* Potassium 2 - Frequency (times per season)
* Potassium 2 - How many representative samples per paddock
* Potassium 3 - Type of test
* Potassium 3 - Frequency (times per season)
* Potassium 3 - How many representative samples per paddock
* How frequently are your clients paddocks tested i.e. every 3 years, every 5 years ... other?9

#### **Question 17 micronutrients**
And, which tests do you use for micronutrients?

* 1 - Type of test
* 1 - Frequency (times per season)
* 1 - How many cores per paddock
* 2 - Type of test
* 2 - Frequency (times per season)
* 2 - How many cores per paddock
* 3 - Type of test
* 3 - Frequency (times per season)
* 3 - How many cores per paddock
* 4 - Type of test
* 4 - Frequency (times per season)
* 4 - How many cores per paddock
* 5 - Type of test
* 5 - Frequency (times per season)
* 5 - How many cores per paddock
* 6 - Type of test
* 6 - Frequency (times per season)
* 6 - How many cores per paddock
* 7 - Type of test
* 7 - Frequency (times per season)
* 7 - How many cores per paddock
* 8 - Type of test
* 8 - Frequency (times per season)
* 8 - How many cores per paddock
* How frequently are your clients paddocks tested i.e. every 3 years, every 5 years ... other?10

#### **Question 18**
What are the top 3 reasons for soil testing on your clients farms ...

* 1
* 2
* 3

#### **Question 19**
Please indicate why you don't do more SOIL Nitrogen testing:

* The cost of soil sampling
* The time required for soil sampling
* The cost of soil testing lab analysis
* The difficulty in being able to represent the variability in a paddock
* The level of accuracy of soil testing lab analysis
* The ability to translate soil test results into a profitable fertiliser decision for my paddock
* Not being able to get soil test results at the right time for decision making
* General comments:

```{r Q19 for agro and grower data work up and DT summary, echo=FALSE}

Q19_why_not_moreN_cost <- data %>%
  group_by(  Q_19.1 ) %>%
  summarise(n = n()) %>%
  mutate(percent =(freq = n / sum(n)),
         type = "Q19_why_not_moreN_cost") %>% 
  filter( Q_19.1 != "NA") %>% 
  select(percent, type)


Q19_why_not_moreN_time <- data %>%
  group_by(  Q_19.2) %>%
  summarise(n = n()) %>%
  mutate(percent =(freq = n / sum(n)),
         type = "Q19_why_not_moreN_time") %>% 
  filter( Q_19.2 != "NA") %>% 
  select(percent, type)

Q19_why_not_moreN_lab_cost <- data %>%
  group_by(  Q_19.3 ) %>%
  summarise(n = n()) %>%
  mutate(percent =(freq = n / sum(n)),
         type = "Q19_why_not_moreN_lab_cost") %>% 
  filter( Q_19.3 != "NA") %>% 
  select(percent, type)

Q19_why_not_moreN_variability <- data %>%
  group_by(  Q_19.4 ) %>%
  summarise(n = n()) %>%
  mutate(percent =(freq = n / sum(n)),
         type = "Q19_why_not_moreN_variability")%>% 
  filter( Q_19.4 != "NA") %>% 
  select(percent, type)


Q19_why_not_moreN_lab_accuracy <- data %>%
  group_by(  Q_19.5 ) %>%
  summarise(n = n()) %>%
  mutate(percent =(freq = n / sum(n)),
         type = "Q19_why_not_moreN_lab_accuracy")%>% 
  filter( Q_19.5 != "NA") %>% 
  select(percent, type)


Q19_why_not_moreN_test_profit_decis <- data %>%
  group_by(  Q_19.6 ) %>%
  summarise(n = n()) %>%
  mutate(percent =(freq = n / sum(n)),
         type = "Q19_why_not_moreN_test_profit_decis")%>% 
  filter( Q_19.6 != "NA") %>% 
  select(percent, type)

Q19_why_not_moreN_too_slow <- data %>%
  group_by(  Q_19.7 ) %>%
  summarise(n = n()) %>%
  mutate(percent =(freq = n / sum(n)),
         type = "Q19_why_not_moreN_too_slow")%>% 
  filter( Q_19.7 != "NA") %>% 
  select(percent, type)




#merge all my dataframes into one
Q19_why_not_moreN <- rbind(Q19_why_not_moreN_cost,
                           Q19_why_not_moreN_time,
                           Q19_why_not_moreN_lab_cost,
                           Q19_why_not_moreN_variability,
                           Q19_why_not_moreN_lab_accuracy,
                           Q19_why_not_moreN_test_profit_decis,
                           Q19_why_not_moreN_too_slow) %>% 
                           arrange(desc(percent))
#make a new column for names to use when graphing
Q19_why_not_moreN <- mutate(Q19_why_not_moreN,
                                        percent1 = round(percent*100,2),
                                        label_name = case_when(
                                          type == "Q19_why_not_moreN_cost" ~ "cost",
                                          type == "Q19_why_not_moreN_time" ~ "time",
                                          type == "Q19_why_not_moreN_lab_cost" ~ "cost of lab analysis",
                                          type == "Q19_why_not_moreN_variability" ~ "variability",
                                          type == "Q19_why_not_moreN_lab_accuracy" ~ "accuracy",
                                          type == "Q19_why_not_moreN_test_profit_decis" ~ "translate profitable decision",
                                          type == "Q19_why_not_moreN_too_slow" ~ "get results at right time") ) 

ggplot(Q19_why_not_moreN, aes(x = reorder(label_name, -percent), y = percent))+
  geom_col()+
  geom_text(aes(label = percent(signif(percent),1), vjust = -1.0, hjust = 0.5))+
  theme_classic()+
  labs(x= "reasons",
       y = "",
       title = "Please indicate why you don't do more SOIL Nitrogen testing:",
       subtitle = "Agronomist and grower",
       caption = "Please indicate why you don't do more SOIL Nitrogen testing:")+
  theme(axis.text.x=element_text(angle=45,hjust=1),
        plot.caption = element_text(size = 8, hjust = 0))+
   scale_y_continuous(labels = scales::percent, limits=c(0, 0.5))


```


#### **Question 20**
Please indicate why you don't do more SOIL Phosphorous testing

* The cost of soil sampling
* The time required for soil sampling
* The cost of soil testing lab analysis
* The difficulty in being able to represent the variability in a paddock
* The level of accuracy of soil testing lab analysis
* The ability to translate soil test results into a profitable fertiliser decision for my paddock
* Not being able to get soil test results at the right time for decision making
* General comments:


```{r Q20 agro and grower data work up and graph, echo=FALSE}



  
  
  Q20_why_not_moreP_cost <- data %>%
    group_by(  Q_20.1 ) %>%
    summarise(n = n()) %>%
    mutate(percent =(freq = n / sum(n)),
           type = "Q20_why_not_moreP_cost") %>% 
    filter( Q_20.1 != "NA") %>% 
    select(percent, type)
  
  Q20_why_not_moreP_time <- data %>%
    group_by(  Q_20.2 ) %>%
    summarise(n = n()) %>%
    mutate(percent =(freq = n / sum(n)),
           type = "Q20_why_not_moreP_time") %>% 
    filter( Q_20.2 != "NA") %>% 
    select(percent, type)
  
  Q20_why_not_moreP_lab_cost <- data %>%
    group_by(  Q_20.3 ) %>%
    summarise(n = n()) %>%
    mutate(percent =(freq = n / sum(n)),
           type = "Q20_why_not_moreP_lab_cost")%>% 
    filter( Q_20.3 != "NA") %>% 
    select(percent, type)
  
  Q20_why_not_moreP_variability <- data %>%
    group_by(  Q_20.4 ) %>%
    summarise(n = n()) %>%
    mutate(percent =(freq = n / sum(n)),
           type = "Q20_why_not_moreP_variability")%>% 
    filter( Q_20.4 != "NA") %>% 
    select(percent, type)
  
  Q20_why_not_moreP_lab_accuracy <- data %>%
    group_by(  Q_20.5) %>%
    summarise(n = n()) %>%
    mutate(percent =(freq = n / sum(n)),
           type = "Q20_why_not_moreP_lab_accuracy")%>% 
    filter( Q_20.5 != "NA") %>% 
    select(percent, type)
  
  Q20_why_not_moreP_test_profit_decis <- data %>%
    group_by( Q_20.6 ) %>%
    summarise(n = n()) %>%
    mutate(percent =(freq = n / sum(n)),
           type = "Q20_why_not_moreP_test_profit_decis")%>% 
    filter( Q_20.6 != "NA") %>% 
    select(percent, type)
  
  Q20_why_not_moreP_too_slow <- data %>%
    group_by(  Q_20.7 ) %>%
    summarise(n = n()) %>%
    mutate(percent =(freq = n / sum(n)),
           type = "Q20_why_not_moreP_too_slow") %>% 
    filter( Q_20.7 != "NA") %>% 
    select(percent, type)
  
  
  
  Q20_why_not_moreP <- rbind(Q20_why_not_moreP_cost,
                             Q20_why_not_moreP_time,
                             Q20_why_not_moreP_lab_cost,
                             Q20_why_not_moreP_variability,
                             Q20_why_not_moreP_lab_accuracy,
                             Q20_why_not_moreP_test_profit_decis,
                             Q20_why_not_moreP_too_slow)
Q20_why_not_moreP <- mutate(Q20_why_not_moreP,
                              percent1 = round(percent*100,2),
                              label_name = case_when(
                                type == "Q20_why_not_moreP_cost" ~ "cost",
                                type == "Q20_why_not_moreP_time" ~ "time",
                                type == "Q20_why_not_moreP_lab_cost" ~ "cost of lab analysis",
                                type == "Q20_why_not_moreP_variability" ~ "variability",
                                type == "Q20_why_not_moreP_lab_accuracy" ~ "accuracy",
                                type == "Q20_why_not_moreP_test_profit_decis" ~ "translate profitable decision",
                                type == "Q20_why_not_moreP_too_slow" ~ "get results at right time") ) 
  
  
  
  
  #head(Q17_why_not_moreP)
  ggplot(Q20_why_not_moreP, aes(x = reorder(label_name, -percent), y = percent))+
    geom_col()+
    geom_text(aes(label = percent(signif(percent),1), vjust = -1.0, hjust = 0.5))+
    theme_classic()+
    labs(x= "reasons",
         y = "",
         title = "Please indicate why you don't do more SOIL P testing:",
         subtitle = "Agronomist and growers",
         caption = "Please indicate why you don't do more SOIL Phosphorous testing")+
    theme(axis.text.x=element_text(angle=45,hjust=1),
          plot.caption = element_text(size = 8, hjust = 0))+
    scale_y_continuous(labels = scales::percent, limits=c(0, 0.5))
  
```
  
  

#### **Question 21** 

Please indicate if you agree/disagree with the following statements in relation to SOIL testing.

* My clients businesses would be more profitable if they did more soil testing than they do now
* Uncertainty about how the season will turn out makes it hard to get value from soil testing results
* My clients recommend the use of regular soil testing to other local farmers
* Feel free to comment on this response


#### **Question 22** 
On average, how much would your clients spend each year on soil testing (including sampling)?

#### **Question 23** 
Compared to five years' ago, has the amount of soil testing you do / recommend changed?

#### **Question 24** 
In five years' time, how much soil sampling do you expect to be doing / recommending?

# PLANT TESTING 

#### **Question 25**
How do you currently use plant testing?

#### **Question 26**
Please list the main 3 reasons you use plant testing data?

#### **Question 27**
Please indicate why you don't do more PLANT testing

* The cost of sampling
* The time required for sampling
* The cost of lab analysis
* The difficulty in being able to represent the variability in a paddock29
* The level of accuracy of lab analysis
* The ability to translate test results into a profitable decision
* Not being able to get test results at the right time for decision making
* General comments


#### **Question 28** 
Agronomist
Please indicate if you agree/disagree with the following statements in relation to PLANT testing

* My clients businesses would be more profitable if they did more plant testing than they do now
* Uncertainty about how the season will turn out makes it hard to get value from plant testing results
* My clients recommend the use of regular plant testing to other local farmers
* Feel free to comment on this response

Grower
Please indicate if you agree/disagree with the following statements in relation to  PLANT testing
* My farm business would be more profitable if I did more plant testing than I do now
* Uncertainty about how the season will turn out makes it hard to get value from plant testing results
* I would recommend the use of regular plant testing to other local farmers


#### **Question 29**
Agronomist
On average, how much would your clients spend per year on plant testing (including sampling)?
Grower
On average, how much would you spend per year on  plant testing (including sampling)?

#### **Question 30** 
Agronomist
Compared to five years' ago, has the amount of plant testing you do / recommend changed?
Grower
Compared to five years' ago, has the amount of plant testing you do on your farm changed?


#### **Question 31**
Agronomist
In five years' time,how much plant sampling do you expect to be doing / recommending?
Grower
In five years' time, how much plant sampling do you expect to be doing?


#### **Question 32**
Agronomist
Grower
Is the use of soil testing on your farm increasing your profitability?


#### **Question 33**
Agronomist
Grower
Please indicate why you don't do SOIL Nitrogen testing

The cost of soil sampling 
The level of accuracy of soil testing lab analysis
The ability to translate soil test results into a profitable fertiliser decision for my paddock
Not being able to get soil test results at the right time for decision making 
The time required for soil sampling 
The cost of soil testing lab analysis 
The difficulty in being able to represent the variability in a paddock 
General comments:


#### **Question 34**
Agronomist
Grower
Please indicate why you don't do SOIL Phosphorous  testing

The cost of soil sampling 
The level of accuracy of soil testing lab analysis
The ability to translate soil test results into a profitable fertiliser decision for my paddock
Not being able to get soil test results at the right time for decision making 
The time required for soil sampling 
The cost of soil testing lab analysis 
The difficulty in being able to represent the variability in a paddock 
General comments:


#### **Question 35** 
Agronomist
Grower
Please indicate if you agree/disagree with the following statements in relation to SOIL testing
* My farm business would be more profitable if I did more soil testing than I do now
* Uncertainty about how the season will turn out makes it hard to get value from soil testing results


#### **Question 36** 
Agronomist
Grower
Please indicate why you don't do any PLANT testing

* The cost of plant sampling
* The time required for plant sampling
* The cost of plant analysis
* The difficulty in being able to represent the variability in a paddock55
* The level of accuracy of plant analysis
* The ability to translate plant test results into a profitable fertiliser decision for my paddock
* Not being able to get plant test results at the right time for decision making
* Comment



#### **Question 37**
Agronomist
Please indicate if you agree/disagree with the following statements in relation to PLANT testing

* My clients businesses would be more profitable if they did more plant testing than they do now
* Uncertainty about how the season will turn out makes it hard to get value from plant testing results
* Feel free to comment on this response

Grower
Please indicate if you agree/disagree with the following statements in relation to  PLANT testing
* My farm business would be more profitable if I did more plant testing than I do now
* Uncertainty about how the season will turn out makes it hard to get value from plant testing results




#### **Question 38** 
What are the barriers to you undertaking...?

* Soil testing? - Sampling cost
* Soil testing? - Analysis cost
* Soil testing? - Sampling time
* Soil testing? - Analysis time
* Soil testing? - Understanding / interpreting results
* Soil testing? - Sampling method
* Plant testing? - Sampling cost
* Plant testing? - Analysis cost
* Plant testing? - Sampling time
* Plant testing? - Analysis time
* Plant testing? - Understanding / interpreting results
* Plant testing? - Sampling method
* Other (please specify)

#### **Question 40**
Please feel free to add any other comments or suggestions

#### **Question 41**
Grower
What information do you require to make better informed decisions regarding nutrient management?

#### **Question 42**
Grower
Where and how would you like to receive information regarding crop nutrition?

* Rural newspapers
* Farm consultants
* Workshops
* Merchandise companies
* Government agencies
* Field days
* Brochures / booklets
* Local trials
* Fertilizer company information, e.g. fact sheets
* Soil or plant testing companies
* Researchers
* Google
* Social media
* Other (please specify)


#### **Question 44**
How do you think researchers or the GRDC could assist you to get a better return on investment for your fertiliser decisions?


#### **Question 45**
Please feel free to add any other comments or suggestions



